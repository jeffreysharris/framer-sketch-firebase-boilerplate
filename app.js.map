{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/fs-web/dist/cjs/core.js","node_modules/fs-web/dist/cjs/directory_entry.js","node_modules/fs-web/dist/cjs/fs.js","node_modules/path-browserify/index.js","node_modules/process/browser.js","src/app.coffee","src/modules/firebaseframer.coffee","src/modules/inputfield.coffee"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AChOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/*fs-web@1.0.0#core*/\n'use strict';\nObject.defineProperty(exports, '__esModule', { value: true });\nexports.readFile = readFile;\nexports.readString = readString;\nexports.writeFile = writeFile;\nexports.removeFile = removeFile;\nexports.readdir = readdir;\nexports.mkdir = mkdir;\nexports.rmdir = rmdir;\nfunction _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : { 'default': obj };\n}\nvar _path = require('path');\nvar _path2 = _interopRequireDefault(_path);\nvar _directory_entry = require('./directory_entry.js');\nvar _directory_entry2 = _interopRequireDefault(_directory_entry);\nfunction ab2str(buf) {\n    return String.fromCharCode.apply(null, new Uint16Array(buf));\n}\nfunction str2ab(str) {\n    var buf = new ArrayBuffer(str.length * 2);\n    var bufView = new Uint16Array(buf);\n    for (var i = 0, strLen = str.length; i < strLen; i++) {\n        bufView[i] = str.charCodeAt(i);\n    }\n    return buf;\n}\nvar DB_NAME = window.location.host + '_filesystem', OS_NAME = 'files', DIR_IDX = 'dir';\nfunction init(callback) {\n    var req = window.indexedDB.open(DB_NAME, 1);\n    req.onupgradeneeded = function (e) {\n        var db = e.target.result;\n        var objectStore = db.createObjectStore(OS_NAME, { keyPath: 'path' });\n        objectStore.createIndex(DIR_IDX, 'dir', { unique: false });\n    };\n    req.onsuccess = function (e) {\n        callback(e.target.result);\n    };\n}\nfunction initOS(type, callback) {\n    init(function (db) {\n        var trans = db.transaction([OS_NAME], type), os = trans.objectStore(OS_NAME);\n        callback(os);\n    });\n}\nvar readFrom = function readFrom(fileName) {\n    return new Promise(function (resolve, reject) {\n        initOS('readonly', function (os) {\n            var req = os.get(fileName);\n            req.onerror = reject;\n            req.onsuccess = function (e) {\n                var res = e.target.result;\n                if (res && res.data) {\n                    resolve(res.data);\n                } else {\n                    reject('File not found');\n                }\n            };\n        });\n    });\n};\nfunction readFile(fileName) {\n    return readFrom(fileName).then(function (data) {\n        if (!(data instanceof ArrayBuffer)) {\n            data = str2ab(data.toString());\n        }\n        return data;\n    });\n}\nfunction readString(fileName) {\n    return readFrom(fileName).then(function (data) {\n        if (data instanceof ArrayBuffer) {\n            data = ab2str(data);\n        }\n        return data;\n    });\n}\n;\nfunction writeFile(fileName, data) {\n    return new Promise(function (resolve, reject) {\n        initOS('readwrite', function (os) {\n            var req = os.put({\n                'path': fileName,\n                'dir': _path2['default'].dirname(fileName),\n                'type': 'file',\n                'data': data\n            });\n            req.onerror = reject;\n            req.onsuccess = function (e) {\n                resolve();\n            };\n        });\n    });\n}\n;\nfunction removeFile(fileName) {\n    return new Promise(function (resolve) {\n        initOS('readwrite', function (os) {\n            var req = os['delete'](fileName);\n            req.onerror = req.onsuccess = function (e) {\n                resolve();\n            };\n        });\n    });\n}\n;\nfunction withTrailingSlash(path) {\n    var directoryWithTrailingSlash = path[path.length - 1] === '/' ? path : path + '/';\n    return directoryWithTrailingSlash;\n}\nfunction readdir(directoryName) {\n    return new Promise(function (resolve, reject) {\n        initOS('readonly', function (os) {\n            var dir = _path2['default'].dirname(withTrailingSlash(directoryName));\n            var idx = os.index(DIR_IDX);\n            var range = IDBKeyRange.only(dir);\n            var req = idx.openCursor(range);\n            req.onerror = function (e) {\n                reject(e);\n            };\n            var results = [];\n            req.onsuccess = function (e) {\n                var cursor = e.target.result;\n                if (cursor) {\n                    var value = cursor.value;\n                    var entry = new _directory_entry2['default'](value.path, value.type);\n                    results.push(entry);\n                    cursor['continue']();\n                } else {\n                    resolve(results);\n                }\n            };\n        });\n    });\n}\n;\nfunction mkdir(fullPath) {\n    return new Promise(function (resolve, reject) {\n        initOS('readwrite', function (os) {\n            var dir = withTrailingSlash(_path2['default']);\n            var req = os.put({\n                'path': fullPath,\n                'dir': _path2['default'].dirname(dir),\n                'type': 'directory'\n            });\n            req.onerror = reject;\n            req.onsuccess = function (e) {\n                resolve();\n            };\n        });\n    });\n}\n;\nfunction rmdir(fullPath) {\n    return readdir(fullPath).then(function removeFiles(files) {\n        if (!files || !files.length) {\n            return removeFile(fullPath);\n        }\n        var file = files.shift(), func = file.type === 'directory' ? rmdir : removeFile;\n        return func(file.name).then(function () {\n            return removeFiles(files);\n        });\n    });\n}\n;","/*fs-web@1.0.0#directory_entry*/\n'use strict';\nObject.defineProperty(exports, '__esModule', { value: true });\nfunction _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : { 'default': obj };\n}\nvar _path = require('path');\nvar _path2 = _interopRequireDefault(_path);\nfunction DirectoryEntry(fullPath, type) {\n    this.path = fullPath;\n    this.name = _path2['default'].basename(fullPath);\n    this.dir = _path2['default'].dirname(fullPath);\n    this.type = type;\n}\nexports['default'] = DirectoryEntry;\nmodule.exports = exports['default'];","/*fs-web@1.0.0#fs*/\n'use strict';\nObject.defineProperty(exports, '__esModule', { value: true });\nfunction _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n        return obj;\n    } else {\n        var newObj = {};\n        if (obj != null) {\n            for (var key in obj) {\n                if (Object.prototype.hasOwnProperty.call(obj, key))\n                    newObj[key] = obj[key];\n            }\n        }\n        newObj['default'] = obj;\n        return newObj;\n    }\n}\nfunction _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n    for (var i = 0; i < keys.length; i++) {\n        var key = keys[i];\n        var value = Object.getOwnPropertyDescriptor(defaults, key);\n        if (value && value.configurable && obj[key] === undefined) {\n            Object.defineProperty(obj, key, value);\n        }\n    }\n    return obj;\n}\nfunction _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : { 'default': obj };\n}\nvar _core = require('./core.js');\nvar _directory_entry = require('./directory_entry.js');\nvar _directory_entry2 = _interopRequireDefault(_directory_entry);\n_directory_entry2['default'].prototype.readFile = function (callback) {\n    if (this.type !== 'file') {\n        throw new TypeError('Not a file.');\n    }\n    return (0, _core.readFile)(this.path, callback);\n};\n_defaults(exports, _interopRequireWildcard(_core));\nexports.DirectoryEntry = _directory_entry2['default'];","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nvar splitPathRe =\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\nvar splitPath = function(filename) {\n  return splitPathRe.exec(filename).slice(1);\n};\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function(path) {\n  var result = splitPath(path),\n      root = result[0],\n      dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n};\n\n\nexports.basename = function(path, ext) {\n  var f = splitPath(path)[2];\n  // TODO: make this comparison case-insensitive on windows?\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\n\nexports.extname = function(path) {\n  return splitPath(path)[3];\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var FirebaseFramer, HEIGHT, Input, WIDTH, bg, button, demoDB, field, footer, fs, lineHeight, post, stream, textfield;\n\nfs = require(\"fs-web\");\n\nFirebaseFramer = require('firebaseframer').FirebaseFramer;\n\nInput = require(\"inputfield\").Input;\n\nWIDTH = Framer.Screen.width;\n\nHEIGHT = Framer.Screen.height;\n\nlineHeight = 30;\n\nfs.readdir(\"images\", function(err, files) {\n  return console.log(err);\n});\n\nFramer.Defaults.Animation = {\n  curve: 'spring(150, 10, 0)'\n};\n\ndemoDB = new FirebaseFramer({\n  projectID: \"framer-sketch-firebase-test\",\n  secret: \"lHwsK4ljhwUmMt3EU1ybrMPQcSDgbKhvTIwuqJ9I\",\n  server: \"s-usc1c-nss-134.firebaseio.com\"\n});\n\nbg = new BackgroundLayer({\n  backgroundColor: \"#fafafa\"\n});\n\nfooter = new Layer({\n  x: 0,\n  y: Canvas.height - 230,\n  width: Canvas.width,\n  height: 230,\n  backgroundColor: \"#999\"\n});\n\nstream = new Layer({\n  x: 0,\n  y: 0,\n  width: Canvas.width,\n  height: Canvas.height - 230,\n  backgroundColor: \"transparent\"\n});\n\nbutton = new Layer({\n  x: 620,\n  y: Canvas.height - 200,\n  width: 50,\n  height: 50,\n  image: \"images/button.png\"\n});\n\nbutton.onMouseDown(function() {\n  return button.image = \"images/button-down.png\";\n});\n\nfield = new Layer({\n  x: 100,\n  y: Canvas.height - 200,\n  width: 520,\n  height: 50,\n  image: \"images/field.png\"\n});\n\ntextfield = new Input({\n  setup: false,\n  type: \"text\",\n  x: 100,\n  y: Canvas.height - 200,\n  width: 500,\n  height: 30\n});\n\ntextfield.style = {\n  fontSize: \"14px\",\n  color: \"#333\",\n  fontFamily: \"Helvetica\",\n  padding: \"10px 10px 10px 20px\"\n};\n\npost = function() {\n  if (textfield.value.length) {\n    return demoDB.post('/messages', {\n      \"text\": textfield.value\n    });\n  }\n};\n\ndemoDB.onChange(\"/messages\", function(message) {\n  var child, h, i, j, k, len, line, m, messageArray, ref, ref1, results, t;\n  ref = stream.children;\n  for (j = 0, len = ref.length; j < len; j++) {\n    child = ref[j];\n    child.animate({\n      y: child.y - lineHeight\n    });\n  }\n  messageArray = _.toArray(message);\n  i = 1;\n  h = lineHeight;\n  results = [];\n  for (k = messageArray.length - 1; k >= 0; k += -1) {\n    m = messageArray[k];\n    t = (ref1 = m.text) != null ? ref1 : m;\n    line = new TextLayer({\n      x: 120,\n      textAlign: \"left\",\n      y: Canvas.height - 250 - h * i,\n      text: t,\n      color: \"#333\",\n      font: \"14px/1.5 Helvetica\"\n    });\n    line.parent = stream;\n    results.push(i++);\n  }\n  return results;\n});\n\nbutton.onMouseUp(function() {\n  button.image = \"images/button.png\";\n  return post();\n});\n\ndocument.addEventListener('keypress', function(event) {\n  if (event.keyCode === 13) {\n    event.preventDefault();\n    post();\n    return textfield.value = \"\";\n  }\n});\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2plZmZyZXkuaGFycmlzL0RldmVsb3BtZW50L2ZyYW1lci1za2V0Y2gtZmlyZWJhc2UtYm9pbGVycGxhdGUvc3JjL2FwcC5jb2ZmZWUiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIvVXNlcnMvamVmZnJleS5oYXJyaXMvRGV2ZWxvcG1lbnQvZnJhbWVyLXNrZXRjaC1maXJlYmFzZS1ib2lsZXJwbGF0ZS9zcmMvYXBwLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBOztBQUFBLEVBQUEsR0FBSyxPQUFBLENBQVEsUUFBUjs7QUFDSixpQkFBa0IsT0FBQSxDQUFRLGdCQUFSOztBQUNsQixRQUFTLE9BQUEsQ0FBUSxZQUFSOztBQUVWLEtBQUEsR0FBUSxNQUFNLENBQUMsTUFBTSxDQUFDOztBQUN0QixNQUFBLEdBQVMsTUFBTSxDQUFDLE1BQU0sQ0FBQzs7QUFFdkIsVUFBQSxHQUFhOztBQUViLEVBQUUsQ0FBQyxPQUFILENBQVcsUUFBWCxFQUFxQixTQUFDLEdBQUQsRUFBTSxLQUFOO1NBQ2pCLE9BQU8sQ0FBQyxHQUFSLENBQVksR0FBWjtBQURpQixDQUFyQjs7QUFHQSxNQUFNLENBQUMsUUFBUSxDQUFDLFNBQWhCLEdBQ0U7RUFBQSxLQUFBLEVBQU8sb0JBQVA7OztBQUVGLE1BQUEsR0FBUyxJQUFJLGNBQUosQ0FDUjtFQUFBLFNBQUEsRUFBVyw2QkFBWDtFQUNBLE1BQUEsRUFBUSwwQ0FEUjtFQUVBLE1BQUEsRUFBUSxnQ0FGUjtDQURROztBQUtULEVBQUEsR0FBSyxJQUFJLGVBQUosQ0FDRDtFQUFBLGVBQUEsRUFBaUIsU0FBakI7Q0FEQzs7QUFHTCxNQUFBLEdBQVMsSUFBSSxLQUFKLENBQ0w7RUFBQSxDQUFBLEVBQUksQ0FBSjtFQUNBLENBQUEsRUFBSSxNQUFNLENBQUMsTUFBUCxHQUFnQixHQURwQjtFQUVBLEtBQUEsRUFBTyxNQUFNLENBQUMsS0FGZDtFQUdBLE1BQUEsRUFBUSxHQUhSO0VBSUEsZUFBQSxF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\n","var extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nexports.FirebaseFramer = (function(superClass) {\n  var getCORSurl, request;\n\n  extend(FirebaseFramer, superClass);\n\n  getCORSurl = function(server, path, secret, project) {\n    var url;\n    switch (Utils.isWebKit()) {\n      case true:\n        url = \"https://\" + server + path + \".json?auth=\" + secret + \"&ns=\" + project + \"&sse=true\";\n        break;\n      default:\n        url = \"https://\" + project + \".firebaseio.com\" + path + \".json?auth=\" + secret;\n    }\n    return url;\n  };\n\n  FirebaseFramer.define(\"status\", {\n    get: function() {\n      return this._status;\n    }\n  });\n\n  function FirebaseFramer(options) {\n    var base, base1, base2, base3;\n    this.options = options != null ? options : {};\n    this.projectID = (base = this.options).projectID != null ? base.projectID : base.projectID = null;\n    this.secret = (base1 = this.options).secret != null ? base1.secret : base1.secret = null;\n    this.server = (base2 = this.options).server != null ? base2.server : base2.server = void 0;\n    this.debug = (base3 = this.options).debug != null ? base3.debug : base3.debug = false;\n    if (this._status == null) {\n      this._status = \"disconnected\";\n    }\n    FirebaseFramer.__super__.constructor.apply(this, arguments);\n    if (this.server === void 0) {\n      Utils.domLoadJSON(\"https://\" + this.projectID + \".firebaseio.com/.settings/owner.json\", function(a, server) {\n        var msg;\n        print(msg = \"Add ______ server:\" + '   \"' + server + '\"' + \" _____ to your instance of Firebase.\");\n        if (this.debug) {\n          return console.log(\"Firebase: \" + msg);\n        }\n      });\n    }\n    if (this.debug) {\n      console.log(\"Firebase: Connecting to Firebase Project '\" + this.projectID + \"' ... \\n URL: '\" + (getCORSurl(this.server, \"/\", this.secret, this.projectID)) + \"'\");\n    }\n    this.onChange(\"connection\");\n  }\n\n  request = function(project, secret, path, callback, method, data, parameters, debug) {\n    var url, xhttp;\n    url = \"https://\" + project + \".firebaseio.com\" + path + \".json?auth=\" + secret;\n    if (parameters !== void 0) {\n      if (parameters.shallow) {\n        url += \"&shallow=true\";\n      }\n      if (parameters.format === \"export\") {\n        url += \"&format=export\";\n      }\n      switch (parameters.print) {\n        case \"pretty\":\n          url += \"&print=pretty\";\n          break;\n        case \"silent\":\n          url += \"&print=silent\";\n      }\n      if (typeof parameters.download === \"string\") {\n        url += \"&download=\" + parameters.download;\n        window.open(url, \"_self\");\n      }\n      if (typeof parameters.orderBy === \"string\") {\n        url += \"&orderBy=\" + '\"' + parameters.orderBy + '\"';\n      }\n      if (typeof parameters.limitToFirst === \"number\") {\n        url += \"&limitToFirst=\" + parameters.limitToFirst;\n      }\n      if (typeof parameters.limitToLast === \"number\") {\n        url += \"&limitToLast=\" + parameters.limitToLast;\n      }\n      if (typeof parameters.startAt === \"number\") {\n        url += \"&startAt=\" + parameters.startAt;\n      }\n      if (typeof parameters.endAt === \"number\") {\n        url += \"&endAt=\" + parameters.endAt;\n      }\n      if (typeof parameters.equalTo === \"number\") {\n        url += \"&equalTo=\" + parameters.equalTo;\n      }\n    }\n    xhttp = new XMLHttpRequest;\n    if (debug) {\n      console.log(\"Firebase: New '\" + method + \"'-request with data: '\" + (JSON.stringify(data)) + \"' \\n URL: '\" + url + \"'\");\n    }\n    xhttp.onreadystatechange = (function(_this) {\n      return function() {\n        if (parameters !== void 0) {\n          if (parameters.print === \"silent\" || typeof parameters.download === \"string\") {\n            return;\n          }\n        }\n        switch (xhttp.readyState) {\n          case 0:\n            if (debug) {\n              console.log(\"Firebase: Request not initialized \\n URL: '\" + url + \"'\");\n            }\n            break;\n          case 1:\n            if (debug) {\n              console.log(\"Firebase: Server connection established \\n URL: '\" + url + \"'\");\n            }\n            break;\n          case 2:\n            if (debug) {\n              console.log(\"Firebase: Request received \\n URL: '\" + url + \"'\");\n            }\n            break;\n          case 3:\n            if (debug) {\n              console.log(\"Firebase: Processing request \\n URL: '\" + url + \"'\");\n            }\n            break;\n          case 4:\n            if (callback != null) {\n              callback(JSON.parse(xhttp.responseText));\n            }\n            if (debug) {\n              console.log(\"Firebase: Request finished, response: '\" + (JSON.parse(xhttp.responseText)) + \"' \\n URL: '\" + url + \"'\");\n            }\n        }\n        if (xhttp.status === \"404\") {\n          if (debug) {\n            return console.warn(\"Firebase: Invalid request, page not found \\n URL: '\" + url + \"'\");\n          }\n        }\n      };\n    })(this);\n    xhttp.open(method, url, true);\n    xhttp.setRequestHeader(\"Content-type\", \"application/json; charset=utf-8\");\n    return xhttp.send(data = \"\" + (JSON.stringify(data)));\n  };\n\n  FirebaseFramer.prototype.get = function(path, callback, parameters) {\n    return request(this.projectID, this.secret, path, callback, \"GET\", null, parameters, this.debug);\n  };\n\n  FirebaseFramer.prototype.put = function(path, data, callback, parameters) {\n    return request(this.projectID, this.secret, path, callback, \"PUT\", data, parameters, this.debug);\n  };\n\n  FirebaseFramer.prototype.post = function(path, data, callback, parameters) {\n    return request(this.projectID, this.secret, path, callback, \"POST\", data, parameters, this.debug);\n  };\n\n  FirebaseFramer.prototype.patch = function(path, data, callback, parameters) {\n    return request(this.projectID, this.secret, path, callback, \"PATCH\", data, parameters, this.debug);\n  };\n\n  FirebaseFramer.prototype[\"delete\"] = function(path, callback, parameters) {\n    return request(this.projectID, this.secret, path, callback, \"DELETE\", null, parameters, this.debug);\n  };\n\n  FirebaseFramer.prototype.onChange = function(path, callback) {\n    var currentStatus, source, url;\n    if (path === \"connection\") {\n      url = getCORSurl(this.server, \"/\", this.secret, this.projectID);\n      currentStatus = \"disconnected\";\n      source = new EventSource(url);\n      source.addEventListener(\"open\", (function(_this) {\n        return function() {\n          if (currentStatus === \"disconnected\") {\n            _this._status = \"connected\";\n            if (callback != null) {\n              callback(\"connected\");\n            }\n            if (_this.debug) {\n              console.log(\"Firebase: Connection to Firebase Project '\" + _this.projectID + \"' established\");\n            }\n          }\n          return currentStatus = \"connected\";\n        };\n      })(this));\n      return source.addEventListener(\"error\", (function(_this) {\n        return function() {\n          if (currentStatus === \"connected\") {\n            _this._status = \"disconnected\";\n            if (callback != null) {\n              callback(\"disconnected\");\n            }\n            if (_this.debug) {\n              console.warn(\"Firebase: Connection to Firebase Project '\" + _this.projectID + \"' closed\");\n            }\n          }\n          return currentStatus = \"disconnected\";\n        };\n      })(this));\n    } else {\n      url = getCORSurl(this.server, path, this.secret, this.projectID);\n      source = new EventSource(url);\n      if (this.debug) {\n        console.log(\"Firebase: Listening to changes made to '\" + path + \"' \\n URL: '\" + url + \"'\");\n      }\n      source.addEventListener(\"put\", (function(_this) {\n        return function(ev) {\n          if (callback != null) {\n            callback(JSON.parse(ev.data).data, \"put\", JSON.parse(ev.data).patch);\n          }\n          if (_this.debug) {\n            return console.log(\"Firebase: Received changes made to '\" + path + \"' via 'PUT': \" + (JSON.parse(ev.data).data) + \" \\n URL: '\" + url + \"'\");\n          }\n        };\n      })(this));\n      return source.addEventListener(\"patch\", (function(_this) {\n        return function(ev) {\n          if (callback != null) {\n            callback(JSON.parse(ev.data).data, \"patch\", JSON.parse(ev.data).patch);\n          }\n          if (_this.debug) {\n            return console.log(\"Firebase: Received changes made to '\" + path + \"' via 'PATCH': \" + (JSON.parse(ev.data).data) + \" \\n URL: '\" + url + \"'\");\n          }\n        };\n      })(this));\n    }\n  };\n\n  return FirebaseFramer;\n\n})(Framer.BaseClass);\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2plZmZyZXkuaGFycmlzL0RldmVsb3BtZW50L2ZyYW1lci1za2V0Y2gtZmlyZWJhc2UtYm9pbGVycGxhdGUvc3JjL21vZHVsZXMvZmlyZWJhc2VmcmFtZXIuY29mZmVlIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiL1VzZXJzL2plZmZyZXkuaGFycmlzL0RldmVsb3BtZW50L2ZyYW1lci1za2V0Y2gtZmlyZWJhc2UtYm9pbGVycGxhdGUvc3JjL21vZHVsZXMvZmlyZWJhc2VmcmFtZXIuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWlCQSxJQUFBOzs7QUFBTSxPQUFPLENBQUM7QUFJYixNQUFBOzs7O0VBQUEsVUFBQSxHQUFhLFNBQUMsTUFBRCxFQUFTLElBQVQsRUFBZSxNQUFmLEVBQXVCLE9BQXZCO0FBRVosUUFBQTtBQUFBLFlBQU8sS0FBSyxDQUFDLFFBQU4sQ0FBQSxDQUFQO0FBQUEsV0FDTSxJQUROO1FBQ2dCLEdBQUEsR0FBTSxVQUFBLEdBQVcsTUFBWCxHQUFvQixJQUFwQixHQUF5QixhQUF6QixHQUFzQyxNQUF0QyxHQUE2QyxNQUE3QyxHQUFtRCxPQUFuRCxHQUEyRDtBQUEzRTtBQUROO1FBRWdCLEdBQUEsR0FBTSxVQUFBLEdBQVcsT0FBWCxHQUFtQixpQkFBbkIsR0FBb0MsSUFBcEMsR0FBeUMsYUFBekMsR0FBc0Q7QUFGNUU7QUFJQSxXQUFPO0VBTks7O0VBU2IsY0FBQyxDQUFDLE1BQUYsQ0FBUyxRQUFULEVBQ0M7SUFBQSxHQUFBLEVBQUssU0FBQTthQUFHLElBQUMsQ0FBQTtJQUFKLENBQUw7R0FERDs7RUFHYSx3QkFBQyxPQUFEO0FBQ1osUUFBQTtJQURhLElBQUMsQ0FBQSw0QkFBRCxVQUFTO0lBQ3RCLElBQUMsQ0FBQSxTQUFELGlEQUFxQixDQUFDLGdCQUFELENBQUMsWUFBYTtJQUNuQyxJQUFDLENBQUEsTUFBRCxnREFBcUIsQ0FBQyxjQUFELENBQUMsU0FBYTtJQUNuQyxJQUFDLENBQUEsTUFBRCxn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\n","var extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nexports.Input = (function(superClass) {\n  extend(Input, superClass);\n\n  Input.define(\"style\", {\n    get: function() {\n      return this.input.style;\n    },\n    set: function(value) {\n      return _.extend(this.input.style, value);\n    }\n  });\n\n  Input.define(\"value\", {\n    get: function() {\n      return this.input.value;\n    },\n    set: function(value) {\n      return this.input.value = value;\n    }\n  });\n\n  function Input(options) {\n    if (options == null) {\n      options = {};\n    }\n    if (options.setup == null) {\n      options.setup = false;\n    }\n    if (options.width == null) {\n      options.width = Screen.width;\n    }\n    if (options.clip == null) {\n      options.clip = false;\n    }\n    if (options.height == null) {\n      options.height = 60;\n    }\n    if (options.backgroundColor == null) {\n      options.backgroundColor = options.setup ? \"rgba(255, 60, 47, .5)\" : \"transparent\";\n    }\n    if (options.fontSize == null) {\n      options.fontSize = 30;\n    }\n    if (options.lineHeight == null) {\n      options.lineHeight = 30;\n    }\n    if (options.padding == null) {\n      options.padding = 10;\n    }\n    if (options.fontFamily == null) {\n      options.fontFamily = \"\";\n    }\n    if (options.opacity == null) {\n      options.opacity = 1;\n    }\n    if (options.text == null) {\n      options.text = \"\";\n    }\n    if (options.placeholder == null) {\n      options.placeholder = \"\";\n    }\n    if (options.type == null) {\n      options.type = \"text\";\n    }\n    Input.__super__.constructor.call(this, options);\n    if (options.placeholderColor != null) {\n      this.placeholderColor = options.placeholderColor;\n    }\n    this.input = document.createElement(\"input\");\n    this.input.id = \"input-\" + (_.now());\n    this.input.style.cssText = \"font-size: \" + options.fontSize + \"px; line-height: \" + options.lineHeight + \"px; padding: \" + options.padding + \"px; width: \" + options.width + \"px; height: \" + options.height + \"px; border: none; outline-width: 0; background-image: url(about:blank); background-color: \" + options.backgroundColor + \"; font-family: \" + options.fontFamily + \"; opacity: \" + options.opacity + \";\";\n    this.input.value = options.text;\n    this.input.type = options.type;\n    this.input.placeholder = options.placeholder;\n    this.form = document.createElement(\"form\");\n    this.form.appendChild(this.input);\n    this._element.appendChild(this.form);\n    this.backgroundColor = \"transparent\";\n    if (this.placeholderColor) {\n      this.updatePlaceholderColor(options.placeholderColor);\n    }\n  }\n\n  Input.prototype.updatePlaceholderColor = function(color) {\n    var css;\n    this.placeholderColor = color;\n    if (this.pageStyle != null) {\n      document.head.removeChild(this.pageStyle);\n    }\n    this.pageStyle = document.createElement(\"style\");\n    this.pageStyle.type = \"text/css\";\n    css = \"#\" + this.input.id + \"::-webkit-input-placeholder { color: \" + this.placeholderColor + \"; }\";\n    this.pageStyle.appendChild(document.createTextNode(css));\n    return document.head.appendChild(this.pageStyle);\n  };\n\n  Input.prototype.focus = function() {\n    return this.input.focus();\n  };\n\n  return Input;\n\n})(Layer);\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2plZmZyZXkuaGFycmlzL0RldmVsb3BtZW50L2ZyYW1lci1za2V0Y2gtZmlyZWJhc2UtYm9pbGVycGxhdGUvc3JjL21vZHVsZXMvaW5wdXRmaWVsZC5jb2ZmZWUiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIvVXNlcnMvamVmZnJleS5oYXJyaXMvRGV2ZWxvcG1lbnQvZnJhbWVyLXNrZXRjaC1maXJlYmFzZS1ib2lsZXJwbGF0ZS9zcmMvbW9kdWxlcy9pbnB1dGZpZWxkLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxJQUFBOzs7QUFBTSxPQUFPLENBQUM7OztFQUNiLEtBQUMsQ0FBQSxNQUFELENBQVEsT0FBUixFQUNDO0lBQUEsR0FBQSxFQUFLLFNBQUE7YUFBRyxJQUFDLENBQUEsS0FBSyxDQUFDO0lBQVYsQ0FBTDtJQUNBLEdBQUEsRUFBSyxTQUFDLEtBQUQ7YUFDSixDQUFDLENBQUMsTUFBRixDQUFTLElBQUMsQ0FBQSxLQUFLLENBQUMsS0FBaEIsRUFBdUIsS0FBdkI7SUFESSxDQURMO0dBREQ7O0VBS0EsS0FBQyxDQUFBLE1BQUQsQ0FBUSxPQUFSLEVBQ0M7SUFBQSxHQUFBLEVBQUssU0FBQTthQUFHLElBQUMsQ0FBQSxLQUFLLENBQUM7SUFBVixDQUFMO0lBQ0EsR0FBQSxFQUFLLFNBQUMsS0FBRDthQUNKLElBQUMsQ0FBQSxLQUFLLENBQUMsS0FBUCxHQUFlO0lBRFgsQ0FETDtHQUREOztFQUthLGVBQUMsT0FBRDs7TUFBQyxVQUFVOzs7TUFDdkIsT0FBTyxDQUFDLFFBQVM7OztNQUNqQixPQUFPLENBQUMsUUFBUyxNQUFNLENBQUM7OztNQUN4QixPQUFPLENBQUMsT0FBUTs7O01BQ2hCLE9BQU8sQ0FBQyxTQUFVOzs7TUFDbEIsT0FBTyxDQUFDLGtCQUFzQixPQUFPLENBQUMsS0FBWCxHQUFzQix1QkFBdEIsR0FBbUQ7OztNQUM5RSxPQUFPLENBQUMsV0FBWTs7O01BQ3BCLE9BQU8sQ0FBQyxhQUFjOzs7TUFD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\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvZnMtd2ViL2Rpc3QvY2pzL2NvcmUuanMiLCJub2RlX21vZHVsZXMvZnMtd2ViL2Rpc3QvY2pzL2RpcmVjdG9yeV9lbnRyeS5qcyIsIm5vZGVfbW9kdWxlcy9mcy13ZWIvZGlzdC9janMvZnMuanMiLCJub2RlX21vZHVsZXMvcGF0aC1icm93c2VyaWZ5L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsInNyYy9hcHAuY29mZmVlIiwic3JjL21vZHVsZXMvZmlyZWJhc2VmcmFtZXIuY29mZmVlIiwic3JjL21vZHVsZXMvaW5wdXRmaWVsZC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNoT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeE9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qZnMtd2ViQDEuMC4wI2NvcmUqL1xuJ3VzZSBzdHJpY3QnO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMucmVhZEZpbGUgPSByZWFkRmlsZTtcbmV4cG9ydHMucmVhZFN0cmluZyA9IHJlYWRTdHJpbmc7XG5leHBvcnRzLndyaXRlRmlsZSA9IHdyaXRlRmlsZTtcbmV4cG9ydHMucmVtb3ZlRmlsZSA9IHJlbW92ZUZpbGU7XG5leHBvcnRzLnJlYWRkaXIgPSByZWFkZGlyO1xuZXhwb3J0cy5ta2RpciA9IG1rZGlyO1xuZXhwb3J0cy5ybWRpciA9IHJtZGlyO1xuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHtcbiAgICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9O1xufVxudmFyIF9wYXRoID0gcmVxdWlyZSgncGF0aCcpO1xudmFyIF9wYXRoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BhdGgpO1xudmFyIF9kaXJlY3RvcnlfZW50cnkgPSByZXF1aXJlKCcuL2RpcmVjdG9yeV9lbnRyeS5qcycpO1xudmFyIF9kaXJlY3RvcnlfZW50cnkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGlyZWN0b3J5X2VudHJ5KTtcbmZ1bmN0aW9uIGFiMnN0cihidWYpIHtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBuZXcgVWludDE2QXJyYXkoYnVmKSk7XG59XG5mdW5jdGlvbiBzdHIyYWIoc3RyKSB7XG4gICAgdmFyIGJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcihzdHIubGVuZ3RoICogMik7XG4gICAgdmFyIGJ1ZlZpZXcgPSBuZXcgVWludDE2QXJyYXkoYnVmKTtcbiAgICBmb3IgKHZhciBpID0gMCwgc3RyTGVuID0gc3RyLmxlbmd0aDsgaSA8IHN0ckxlbjsgaSsrKSB7XG4gICAgICAgIGJ1ZlZpZXdbaV0gPSBzdHIuY2hhckNvZGVBdChpKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1Zjtcbn1cbnZhciBEQl9OQU1FID0gd2luZG93LmxvY2F0aW9uLmhvc3QgKyAnX2ZpbGVzeXN0ZW0nLCBPU19OQU1FID0gJ2ZpbGVzJywgRElSX0lEWCA9ICdkaXInO1xuZnVuY3Rpb24gaW5pdChjYWxsYmFjaykge1xuICAgIHZhciByZXEgPSB3aW5kb3cuaW5kZXhlZERCLm9wZW4oREJfTkFNRSwgMSk7XG4gICAgcmVxLm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBkYiA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgdmFyIG9iamVjdFN0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoT1NfTkFNRSwgeyBrZXlQYXRoOiAncGF0aCcgfSk7XG4gICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KERJUl9JRFgsICdkaXInLCB7IHVuaXF1ZTogZmFsc2UgfSk7XG4gICAgfTtcbiAgICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgY2FsbGJhY2soZS50YXJnZXQucmVzdWx0KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gaW5pdE9TKHR5cGUsIGNhbGxiYWNrKSB7XG4gICAgaW5pdChmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgdmFyIHRyYW5zID0gZGIudHJhbnNhY3Rpb24oW09TX05BTUVdLCB0eXBlKSwgb3MgPSB0cmFucy5vYmplY3RTdG9yZShPU19OQU1FKTtcbiAgICAgICAgY2FsbGJhY2sob3MpO1xuICAgIH0pO1xufVxudmFyIHJlYWRGcm9tID0gZnVuY3Rpb24gcmVhZEZyb20oZmlsZU5hbWUpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBpbml0T1MoJ3JlYWRvbmx5JywgZnVuY3Rpb24gKG9zKSB7XG4gICAgICAgICAgICB2YXIgcmVxID0gb3MuZ2V0KGZpbGVOYW1lKTtcbiAgICAgICAgICAgIHJlcS5vbmVycm9yID0gcmVqZWN0O1xuICAgICAgICAgICAgcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICBpZiAocmVzICYmIHJlcy5kYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzLmRhdGEpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgnRmlsZSBub3QgZm91bmQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5mdW5jdGlvbiByZWFkRmlsZShmaWxlTmFtZSkge1xuICAgIHJldHVybiByZWFkRnJvbShmaWxlTmFtZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBpZiAoIShkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpKSB7XG4gICAgICAgICAgICBkYXRhID0gc3RyMmFiKGRhdGEudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSk7XG59XG5mdW5jdGlvbiByZWFkU3RyaW5nKGZpbGVOYW1lKSB7XG4gICAgcmV0dXJuIHJlYWRGcm9tKGZpbGVOYW1lKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgIGRhdGEgPSBhYjJzdHIoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSk7XG59XG47XG5mdW5jdGlvbiB3cml0ZUZpbGUoZmlsZU5hbWUsIGRhdGEpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBpbml0T1MoJ3JlYWR3cml0ZScsIGZ1bmN0aW9uIChvcykge1xuICAgICAgICAgICAgdmFyIHJlcSA9IG9zLnB1dCh7XG4gICAgICAgICAgICAgICAgJ3BhdGgnOiBmaWxlTmFtZSxcbiAgICAgICAgICAgICAgICAnZGlyJzogX3BhdGgyWydkZWZhdWx0J10uZGlybmFtZShmaWxlTmFtZSksXG4gICAgICAgICAgICAgICAgJ3R5cGUnOiAnZmlsZScsXG4gICAgICAgICAgICAgICAgJ2RhdGEnOiBkYXRhXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlcS5vbmVycm9yID0gcmVqZWN0O1xuICAgICAgICAgICAgcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG47XG5mdW5jdGlvbiByZW1vdmVGaWxlKGZpbGVOYW1lKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgIGluaXRPUygncmVhZHdyaXRlJywgZnVuY3Rpb24gKG9zKSB7XG4gICAgICAgICAgICB2YXIgcmVxID0gb3NbJ2RlbGV0ZSddKGZpbGVOYW1lKTtcbiAgICAgICAgICAgIHJlcS5vbmVycm9yID0gcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG47XG5mdW5jdGlvbiB3aXRoVHJhaWxpbmdTbGFzaChwYXRoKSB7XG4gICAgdmFyIGRpcmVjdG9yeVdpdGhUcmFpbGluZ1NsYXNoID0gcGF0aFtwYXRoLmxlbmd0aCAtIDFdID09PSAnLycgPyBwYXRoIDogcGF0aCArICcvJztcbiAgICByZXR1cm4gZGlyZWN0b3J5V2l0aFRyYWlsaW5nU2xhc2g7XG59XG5mdW5jdGlvbiByZWFkZGlyKGRpcmVjdG9yeU5hbWUpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBpbml0T1MoJ3JlYWRvbmx5JywgZnVuY3Rpb24gKG9zKSB7XG4gICAgICAgICAgICB2YXIgZGlyID0gX3BhdGgyWydkZWZhdWx0J10uZGlybmFtZSh3aXRoVHJhaWxpbmdTbGFzaChkaXJlY3RvcnlOYW1lKSk7XG4gICAgICAgICAgICB2YXIgaWR4ID0gb3MuaW5kZXgoRElSX0lEWCk7XG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5vbmx5KGRpcik7XG4gICAgICAgICAgICB2YXIgcmVxID0gaWR4Lm9wZW5DdXJzb3IocmFuZ2UpO1xuICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgICAgICAgICAgcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnNvciA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICBpZiAoY3Vyc29yKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGN1cnNvci52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVudHJ5ID0gbmV3IF9kaXJlY3RvcnlfZW50cnkyWydkZWZhdWx0J10odmFsdWUucGF0aCwgdmFsdWUudHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChlbnRyeSk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnNvclsnY29udGludWUnXSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG47XG5mdW5jdGlvbiBta2RpcihmdWxsUGF0aCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGluaXRPUygncmVhZHdyaXRlJywgZnVuY3Rpb24gKG9zKSB7XG4gICAgICAgICAgICB2YXIgZGlyID0gd2l0aFRyYWlsaW5nU2xhc2goX3BhdGgyWydkZWZhdWx0J10pO1xuICAgICAgICAgICAgdmFyIHJlcSA9IG9zLnB1dCh7XG4gICAgICAgICAgICAgICAgJ3BhdGgnOiBmdWxsUGF0aCxcbiAgICAgICAgICAgICAgICAnZGlyJzogX3BhdGgyWydkZWZhdWx0J10uZGlybmFtZShkaXIpLFxuICAgICAgICAgICAgICAgICd0eXBlJzogJ2RpcmVjdG9yeSdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSByZWplY3Q7XG4gICAgICAgICAgICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbjtcbmZ1bmN0aW9uIHJtZGlyKGZ1bGxQYXRoKSB7XG4gICAgcmV0dXJuIHJlYWRkaXIoZnVsbFBhdGgpLnRoZW4oZnVuY3Rpb24gcmVtb3ZlRmlsZXMoZmlsZXMpIHtcbiAgICAgICAgaWYgKCFmaWxlcyB8fCAhZmlsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3ZlRmlsZShmdWxsUGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbGUgPSBmaWxlcy5zaGlmdCgpLCBmdW5jID0gZmlsZS50eXBlID09PSAnZGlyZWN0b3J5JyA/IHJtZGlyIDogcmVtb3ZlRmlsZTtcbiAgICAgICAgcmV0dXJuIGZ1bmMoZmlsZS5uYW1lKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiByZW1vdmVGaWxlcyhmaWxlcyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuOyIsIi8qZnMtd2ViQDEuMC4wI2RpcmVjdG9yeV9lbnRyeSovXG4ndXNlIHN0cmljdCc7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHtcbiAgICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9O1xufVxudmFyIF9wYXRoID0gcmVxdWlyZSgncGF0aCcpO1xudmFyIF9wYXRoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BhdGgpO1xuZnVuY3Rpb24gRGlyZWN0b3J5RW50cnkoZnVsbFBhdGgsIHR5cGUpIHtcbiAgICB0aGlzLnBhdGggPSBmdWxsUGF0aDtcbiAgICB0aGlzLm5hbWUgPSBfcGF0aDJbJ2RlZmF1bHQnXS5iYXNlbmFtZShmdWxsUGF0aCk7XG4gICAgdGhpcy5kaXIgPSBfcGF0aDJbJ2RlZmF1bHQnXS5kaXJuYW1lKGZ1bGxQYXRoKTtcbiAgICB0aGlzLnR5cGUgPSB0eXBlO1xufVxuZXhwb3J0c1snZGVmYXVsdCddID0gRGlyZWN0b3J5RW50cnk7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsiLCIvKmZzLXdlYkAxLjAuMCNmcyovXG4ndXNlIHN0cmljdCc7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7XG4gICAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkge1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBuZXdPYmogPSB7fTtcbiAgICAgICAgaWYgKG9iaiAhPSBudWxsKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpXG4gICAgICAgICAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbmV3T2JqWydkZWZhdWx0J10gPSBvYmo7XG4gICAgICAgIHJldHVybiBuZXdPYmo7XG4gICAgfVxufVxuZnVuY3Rpb24gX2RlZmF1bHRzKG9iaiwgZGVmYXVsdHMpIHtcbiAgICB2YXIga2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGRlZmF1bHRzKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICAgIHZhciB2YWx1ZSA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZGVmYXVsdHMsIGtleSk7XG4gICAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZS5jb25maWd1cmFibGUgJiYgb2JqW2tleV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9iajtcbn1cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7XG4gICAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTtcbn1cbnZhciBfY29yZSA9IHJlcXVpcmUoJy4vY29yZS5qcycpO1xudmFyIF9kaXJlY3RvcnlfZW50cnkgPSByZXF1aXJlKCcuL2RpcmVjdG9yeV9lbnRyeS5qcycpO1xudmFyIF9kaXJlY3RvcnlfZW50cnkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGlyZWN0b3J5X2VudHJ5KTtcbl9kaXJlY3RvcnlfZW50cnkyWydkZWZhdWx0J10ucHJvdG90eXBlLnJlYWRGaWxlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgaWYgKHRoaXMudHlwZSAhPT0gJ2ZpbGUnKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ05vdCBhIGZpbGUuJyk7XG4gICAgfVxuICAgIHJldHVybiAoMCwgX2NvcmUucmVhZEZpbGUpKHRoaXMucGF0aCwgY2FsbGJhY2spO1xufTtcbl9kZWZhdWx0cyhleHBvcnRzLCBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfY29yZSkpO1xuZXhwb3J0cy5EaXJlY3RvcnlFbnRyeSA9IF9kaXJlY3RvcnlfZW50cnkyWydkZWZhdWx0J107IiwiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbi8vIHJlc29sdmVzIC4gYW5kIC4uIGVsZW1lbnRzIGluIGEgcGF0aCBhcnJheSB3aXRoIGRpcmVjdG9yeSBuYW1lcyB0aGVyZVxuLy8gbXVzdCBiZSBubyBzbGFzaGVzLCBlbXB0eSBlbGVtZW50cywgb3IgZGV2aWNlIG5hbWVzIChjOlxcKSBpbiB0aGUgYXJyYXlcbi8vIChzbyBhbHNvIG5vIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHNsYXNoZXMgLSBpdCBkb2VzIG5vdCBkaXN0aW5ndWlzaFxuLy8gcmVsYXRpdmUgYW5kIGFic29sdXRlIHBhdGhzKVxuZnVuY3Rpb24gbm9ybWFsaXplQXJyYXkocGFydHMsIGFsbG93QWJvdmVSb290KSB7XG4gIC8vIGlmIHRoZSBwYXRoIHRyaWVzIHRvIGdvIGFib3ZlIHRoZSByb290LCBgdXBgIGVuZHMgdXAgPiAwXG4gIHZhciB1cCA9IDA7XG4gIGZvciAodmFyIGkgPSBwYXJ0cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgIHZhciBsYXN0ID0gcGFydHNbaV07XG4gICAgaWYgKGxhc3QgPT09ICcuJykge1xuICAgICAgcGFydHMuc3BsaWNlKGksIDEpO1xuICAgIH0gZWxzZSBpZiAobGFzdCA9PT0gJy4uJykge1xuICAgICAgcGFydHMuc3BsaWNlKGksIDEpO1xuICAgICAgdXArKztcbiAgICB9IGVsc2UgaWYgKHVwKSB7XG4gICAgICBwYXJ0cy5zcGxpY2UoaSwgMSk7XG4gICAgICB1cC0tO1xuICAgIH1cbiAgfVxuXG4gIC8vIGlmIHRoZSBwYXRoIGlzIGFsbG93ZWQgdG8gZ28gYWJvdmUgdGhlIHJvb3QsIHJlc3RvcmUgbGVhZGluZyAuLnNcbiAgaWYgKGFsbG93QWJvdmVSb290KSB7XG4gICAgZm9yICg7IHVwLS07IHVwKSB7XG4gICAgICBwYXJ0cy51bnNoaWZ0KCcuLicpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwYXJ0cztcbn1cblxuLy8gU3BsaXQgYSBmaWxlbmFtZSBpbnRvIFtyb290LCBkaXIsIGJhc2VuYW1lLCBleHRdLCB1bml4IHZlcnNpb25cbi8vICdyb290JyBpcyBqdXN0IGEgc2xhc2gsIG9yIG5vdGhpbmcuXG52YXIgc3BsaXRQYXRoUmUgPVxuICAgIC9eKFxcLz98KShbXFxzXFxTXSo/KSgoPzpcXC57MSwyfXxbXlxcL10rP3wpKFxcLlteLlxcL10qfCkpKD86W1xcL10qKSQvO1xudmFyIHNwbGl0UGF0aCA9IGZ1bmN0aW9uKGZpbGVuYW1lKSB7XG4gIHJldHVybiBzcGxpdFBhdGhSZS5leGVjKGZpbGVuYW1lKS5zbGljZSgxKTtcbn07XG5cbi8vIHBhdGgucmVzb2x2ZShbZnJvbSAuLi5dLCB0bylcbi8vIHBvc2l4IHZlcnNpb25cbmV4cG9ydHMucmVzb2x2ZSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgcmVzb2x2ZWRQYXRoID0gJycsXG4gICAgICByZXNvbHZlZEFic29sdXRlID0gZmFsc2U7XG5cbiAgZm9yICh2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGggLSAxOyBpID49IC0xICYmICFyZXNvbHZlZEFic29sdXRlOyBpLS0pIHtcbiAgICB2YXIgcGF0aCA9IChpID49IDApID8gYXJndW1lbnRzW2ldIDogcHJvY2Vzcy5jd2QoKTtcblxuICAgIC8vIFNraXAgZW1wdHkgYW5kIGludmFsaWQgZW50cmllc1xuICAgIGlmICh0eXBlb2YgcGF0aCAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50cyB0byBwYXRoLnJlc29sdmUgbXVzdCBiZSBzdHJpbmdzJyk7XG4gICAgfSBlbHNlIGlmICghcGF0aCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgcmVzb2x2ZWRQYXRoID0gcGF0aCArICcvJyArIHJlc29sdmVkUGF0aDtcbiAgICByZXNvbHZlZEFic29sdXRlID0gcGF0aC5jaGFyQXQoMCkgPT09ICcvJztcbiAgfVxuXG4gIC8vIEF0IHRoaXMgcG9pbnQgdGhlIHBhdGggc2hvdWxkIGJlIHJlc29sdmVkIHRvIGEgZnVsbCBhYnNvbHV0ZSBwYXRoLCBidXRcbiAgLy8gaGFuZGxlIHJlbGF0aXZlIHBhdGhzIHRvIGJlIHNhZmUgKG1pZ2h0IGhhcHBlbiB3aGVuIHByb2Nlc3MuY3dkKCkgZmFpbHMpXG5cbiAgLy8gTm9ybWFsaXplIHRoZSBwYXRoXG4gIHJlc29sdmVkUGF0aCA9IG5vcm1hbGl6ZUFycmF5KGZpbHRlcihyZXNvbHZlZFBhdGguc3BsaXQoJy8nKSwgZnVuY3Rpb24ocCkge1xuICAgIHJldHVybiAhIXA7XG4gIH0pLCAhcmVzb2x2ZWRBYnNvbHV0ZSkuam9pbignLycpO1xuXG4gIHJldHVybiAoKHJlc29sdmVkQWJzb2x1dGUgPyAnLycgOiAnJykgKyByZXNvbHZlZFBhdGgpIHx8ICcuJztcbn07XG5cbi8vIHBhdGgubm9ybWFsaXplKHBhdGgpXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uKHBhdGgpIHtcbiAgdmFyIGlzQWJzb2x1dGUgPSBleHBvcnRzLmlzQWJzb2x1dGUocGF0aCksXG4gICAgICB0cmFpbGluZ1NsYXNoID0gc3Vic3RyKHBhdGgsIC0xKSA9PT0gJy8nO1xuXG4gIC8vIE5vcm1hbGl6ZSB0aGUgcGF0aFxuICBwYXRoID0gbm9ybWFsaXplQXJyYXkoZmlsdGVyKHBhdGguc3BsaXQoJy8nKSwgZnVuY3Rpb24ocCkge1xuICAgIHJldHVybiAhIXA7XG4gIH0pLCAhaXNBYnNvbHV0ZSkuam9pbignLycpO1xuXG4gIGlmICghcGF0aCAmJiAhaXNBYnNvbHV0ZSkge1xuICAgIHBhdGggPSAnLic7XG4gIH1cbiAgaWYgKHBhdGggJiYgdHJhaWxpbmdTbGFzaCkge1xuICAgIHBhdGggKz0gJy8nO1xuICB9XG5cbiAgcmV0dXJuIChpc0Fic29sdXRlID8gJy8nIDogJycpICsgcGF0aDtcbn07XG5cbi8vIHBvc2l4IHZlcnNpb25cbmV4cG9ydHMuaXNBYnNvbHV0ZSA9IGZ1bmN0aW9uKHBhdGgpIHtcbiAgcmV0dXJuIHBhdGguY2hhckF0KDApID09PSAnLyc7XG59O1xuXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLmpvaW4gPSBmdW5jdGlvbigpIHtcbiAgdmFyIHBhdGhzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKTtcbiAgcmV0dXJuIGV4cG9ydHMubm9ybWFsaXplKGZpbHRlcihwYXRocywgZnVuY3Rpb24ocCwgaW5kZXgpIHtcbiAgICBpZiAodHlwZW9mIHAgIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgdG8gcGF0aC5qb2luIG11c3QgYmUgc3RyaW5ncycpO1xuICAgIH1cbiAgICByZXR1cm4gcDtcbiAgfSkuam9pbignLycpKTtcbn07XG5cblxuLy8gcGF0aC5yZWxhdGl2ZShmcm9tLCB0bylcbi8vIHBvc2l4IHZlcnNpb25cbmV4cG9ydHMucmVsYXRpdmUgPSBmdW5jdGlvbihmcm9tLCB0bykge1xuICBmcm9tID0gZXhwb3J0cy5yZXNvbHZlKGZyb20pLnN1YnN0cigxKTtcbiAgdG8gPSBleHBvcnRzLnJlc29sdmUodG8pLnN1YnN0cigxKTtcblxuICBmdW5jdGlvbiB0cmltKGFycikge1xuICAgIHZhciBzdGFydCA9IDA7XG4gICAgZm9yICg7IHN0YXJ0IDwgYXJyLmxlbmd0aDsgc3RhcnQrKykge1xuICAgICAgaWYgKGFycltzdGFydF0gIT09ICcnKSBicmVhaztcbiAgICB9XG5cbiAgICB2YXIgZW5kID0gYXJyLmxlbmd0aCAtIDE7XG4gICAgZm9yICg7IGVuZCA+PSAwOyBlbmQtLSkge1xuICAgICAgaWYgKGFycltlbmRdICE9PSAnJykgYnJlYWs7XG4gICAgfVxuXG4gICAgaWYgKHN0YXJ0ID4gZW5kKSByZXR1cm4gW107XG4gICAgcmV0dXJuIGFyci5zbGljZShzdGFydCwgZW5kIC0gc3RhcnQgKyAxKTtcbiAgfVxuXG4gIHZhciBmcm9tUGFydHMgPSB0cmltKGZyb20uc3BsaXQoJy8nKSk7XG4gIHZhciB0b1BhcnRzID0gdHJpbSh0by5zcGxpdCgnLycpKTtcblxuICB2YXIgbGVuZ3RoID0gTWF0aC5taW4oZnJvbVBhcnRzLmxlbmd0aCwgdG9QYXJ0cy5sZW5ndGgpO1xuICB2YXIgc2FtZVBhcnRzTGVuZ3RoID0gbGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGZyb21QYXJ0c1tpXSAhPT0gdG9QYXJ0c1tpXSkge1xuICAgICAgc2FtZVBhcnRzTGVuZ3RoID0gaTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIHZhciBvdXRwdXRQYXJ0cyA9IFtdO1xuICBmb3IgKHZhciBpID0gc2FtZVBhcnRzTGVuZ3RoOyBpIDwgZnJvbVBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgb3V0cHV0UGFydHMucHVzaCgnLi4nKTtcbiAgfVxuXG4gIG91dHB1dFBhcnRzID0gb3V0cHV0UGFydHMuY29uY2F0KHRvUGFydHMuc2xpY2Uoc2FtZVBhcnRzTGVuZ3RoKSk7XG5cbiAgcmV0dXJuIG91dHB1dFBhcnRzLmpvaW4oJy8nKTtcbn07XG5cbmV4cG9ydHMuc2VwID0gJy8nO1xuZXhwb3J0cy5kZWxpbWl0ZXIgPSAnOic7XG5cbmV4cG9ydHMuZGlybmFtZSA9IGZ1bmN0aW9uKHBhdGgpIHtcbiAgdmFyIHJlc3VsdCA9IHNwbGl0UGF0aChwYXRoKSxcbiAgICAgIHJvb3QgPSByZXN1bHRbMF0sXG4gICAgICBkaXIgPSByZXN1bHRbMV07XG5cbiAgaWYgKCFyb290ICYmICFkaXIpIHtcbiAgICAvLyBObyBkaXJuYW1lIHdoYXRzb2V2ZXJcbiAgICByZXR1cm4gJy4nO1xuICB9XG5cbiAgaWYgKGRpcikge1xuICAgIC8vIEl0IGhhcyBhIGRpcm5hbWUsIHN0cmlwIHRyYWlsaW5nIHNsYXNoXG4gICAgZGlyID0gZGlyLnN1YnN0cigwLCBkaXIubGVuZ3RoIC0gMSk7XG4gIH1cblxuICByZXR1cm4gcm9vdCArIGRpcjtcbn07XG5cblxuZXhwb3J0cy5iYXNlbmFtZSA9IGZ1bmN0aW9uKHBhdGgsIGV4dCkge1xuICB2YXIgZiA9IHNwbGl0UGF0aChwYXRoKVsyXTtcbiAgLy8gVE9ETzogbWFrZSB0aGlzIGNvbXBhcmlzb24gY2FzZS1pbnNlbnNpdGl2ZSBvbiB3aW5kb3dzP1xuICBpZiAoZXh0ICYmIGYuc3Vic3RyKC0xICogZXh0Lmxlbmd0aCkgPT09IGV4dCkge1xuICAgIGYgPSBmLnN1YnN0cigwLCBmLmxlbmd0aCAtIGV4dC5sZW5ndGgpO1xuICB9XG4gIHJldHVybiBmO1xufTtcblxuXG5leHBvcnRzLmV4dG5hbWUgPSBmdW5jdGlvbihwYXRoKSB7XG4gIHJldHVybiBzcGxpdFBhdGgocGF0aClbM107XG59O1xuXG5mdW5jdGlvbiBmaWx0ZXIgKHhzLCBmKSB7XG4gICAgaWYgKHhzLmZpbHRlcikgcmV0dXJuIHhzLmZpbHRlcihmKTtcbiAgICB2YXIgcmVzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoZih4c1tpXSwgaSwgeHMpKSByZXMucHVzaCh4c1tpXSk7XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG5cbi8vIFN0cmluZy5wcm90b3R5cGUuc3Vic3RyIC0gbmVnYXRpdmUgaW5kZXggZG9uJ3Qgd29yayBpbiBJRThcbnZhciBzdWJzdHIgPSAnYWInLnN1YnN0cigtMSkgPT09ICdiJ1xuICAgID8gZnVuY3Rpb24gKHN0ciwgc3RhcnQsIGxlbikgeyByZXR1cm4gc3RyLnN1YnN0cihzdGFydCwgbGVuKSB9XG4gICAgOiBmdW5jdGlvbiAoc3RyLCBzdGFydCwgbGVuKSB7XG4gICAgICAgIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gc3RyLmxlbmd0aCArIHN0YXJ0O1xuICAgICAgICByZXR1cm4gc3RyLnN1YnN0cihzdGFydCwgbGVuKTtcbiAgICB9XG47XG4iLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuIiwidmFyIEZpcmViYXNlRnJhbWVyLCBIRUlHSFQsIElucHV0LCBXSURUSCwgYmcsIGJ1dHRvbiwgZGVtb0RCLCBmaWVsZCwgZm9vdGVyLCBmcywgbGluZUhlaWdodCwgcG9zdCwgc3RyZWFtLCB0ZXh0ZmllbGQ7XG5cbmZzID0gcmVxdWlyZShcImZzLXdlYlwiKTtcblxuRmlyZWJhc2VGcmFtZXIgPSByZXF1aXJlKCdmaXJlYmFzZWZyYW1lcicpLkZpcmViYXNlRnJhbWVyO1xuXG5JbnB1dCA9IHJlcXVpcmUoXCJpbnB1dGZpZWxkXCIpLklucHV0O1xuXG5XSURUSCA9IEZyYW1lci5TY3JlZW4ud2lkdGg7XG5cbkhFSUdIVCA9IEZyYW1lci5TY3JlZW4uaGVpZ2h0O1xuXG5saW5lSGVpZ2h0ID0gMzA7XG5cbmZzLnJlYWRkaXIoXCJpbWFnZXNcIiwgZnVuY3Rpb24oZXJyLCBmaWxlcykge1xuICByZXR1cm4gY29uc29sZS5sb2coZXJyKTtcbn0pO1xuXG5GcmFtZXIuRGVmYXVsdHMuQW5pbWF0aW9uID0ge1xuICBjdXJ2ZTogJ3NwcmluZygxNTAsIDEwLCAwKSdcbn07XG5cbmRlbW9EQiA9IG5ldyBGaXJlYmFzZUZyYW1lcih7XG4gIHByb2plY3RJRDogXCJmcmFtZXItc2tldGNoLWZpcmViYXNlLXRlc3RcIixcbiAgc2VjcmV0OiBcImxId3NLNGxqaHdVbU10M0VVMXlick1QUWNTRGdiS2h2VEl3dXFKOUlcIixcbiAgc2VydmVyOiBcInMtdXNjMWMtbnNzLTEzNC5maXJlYmFzZWlvLmNvbVwiXG59KTtcblxuYmcgPSBuZXcgQmFja2dyb3VuZExheWVyKHtcbiAgYmFja2dyb3VuZENvbG9yOiBcIiNmYWZhZmFcIlxufSk7XG5cbmZvb3RlciA9IG5ldyBMYXllcih7XG4gIHg6IDAsXG4gIHk6IENhbnZhcy5oZWlnaHQgLSAyMzAsXG4gIHdpZHRoOiBDYW52YXMud2lkdGgsXG4gIGhlaWdodDogMjMwLFxuICBiYWNrZ3JvdW5kQ29sb3I6IFwiIzk5OVwiXG59KTtcblxuc3RyZWFtID0gbmV3IExheWVyKHtcbiAgeDogMCxcbiAgeTogMCxcbiAgd2lkdGg6IENhbnZhcy53aWR0aCxcbiAgaGVpZ2h0OiBDYW52YXMuaGVpZ2h0IC0gMjMwLFxuICBiYWNrZ3JvdW5kQ29sb3I6IFwidHJhbnNwYXJlbnRcIlxufSk7XG5cbmJ1dHRvbiA9IG5ldyBMYXllcih7XG4gIHg6IDYyMCxcbiAgeTogQ2FudmFzLmhlaWdodCAtIDIwMCxcbiAgd2lkdGg6IDUwLFxuICBoZWlnaHQ6IDUwLFxuICBpbWFnZTogXCJpbWFnZXMvYnV0dG9uLnBuZ1wiXG59KTtcblxuYnV0dG9uLm9uTW91c2VEb3duKGZ1bmN0aW9uKCkge1xuICByZXR1cm4gYnV0dG9uLmltYWdlID0gXCJpbWFnZXMvYnV0dG9uLWRvd24ucG5nXCI7XG59KTtcblxuZmllbGQgPSBuZXcgTGF5ZXIoe1xuICB4OiAxMDAsXG4gIHk6IENhbnZhcy5oZWlnaHQgLSAyMDAsXG4gIHdpZHRoOiA1MjAsXG4gIGhlaWdodDogNTAsXG4gIGltYWdlOiBcImltYWdlcy9maWVsZC5wbmdcIlxufSk7XG5cbnRleHRmaWVsZCA9IG5ldyBJbnB1dCh7XG4gIHNldHVwOiBmYWxzZSxcbiAgdHlwZTogXCJ0ZXh0XCIsXG4gIHg6IDEwMCxcbiAgeTogQ2FudmFzLmhlaWdodCAtIDIwMCxcbiAgd2lkdGg6IDUwMCxcbiAgaGVpZ2h0OiAzMFxufSk7XG5cbnRleHRmaWVsZC5zdHlsZSA9IHtcbiAgZm9udFNpemU6IFwiMTRweFwiLFxuICBjb2xvcjogXCIjMzMzXCIsXG4gIGZvbnRGYW1pbHk6IFwiSGVsdmV0aWNhXCIsXG4gIHBhZGRpbmc6IFwiMTBweCAxMHB4IDEwcHggMjBweFwiXG59O1xuXG5wb3N0ID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0ZXh0ZmllbGQudmFsdWUubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGRlbW9EQi5wb3N0KCcvbWVzc2FnZXMnLCB7XG4gICAgICBcInRleHRcIjogdGV4dGZpZWxkLnZhbHVlXG4gICAgfSk7XG4gIH1cbn07XG5cbmRlbW9EQi5vbkNoYW5nZShcIi9tZXNzYWdlc1wiLCBmdW5jdGlvbihtZXNzYWdlKSB7XG4gIHZhciBjaGlsZCwgaCwgaSwgaiwgaywgbGVuLCBsaW5lLCBtLCBtZXNzYWdlQXJyYXksIHJlZiwgcmVmMSwgcmVzdWx0cywgdDtcbiAgcmVmID0gc3RyZWFtLmNoaWxkcmVuO1xuICBmb3IgKGogPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICBjaGlsZCA9IHJlZltqXTtcbiAgICBjaGlsZC5hbmltYXRlKHtcbiAgICAgIHk6IGNoaWxkLnkgLSBsaW5lSGVpZ2h0XG4gICAgfSk7XG4gIH1cbiAgbWVzc2FnZUFycmF5ID0gXy50b0FycmF5KG1lc3NhZ2UpO1xuICBpID0gMTtcbiAgaCA9IGxpbmVIZWlnaHQ7XG4gIHJlc3VsdHMgPSBbXTtcbiAgZm9yIChrID0gbWVzc2FnZUFycmF5Lmxlbmd0aCAtIDE7IGsgPj0gMDsgayArPSAtMSkge1xuICAgIG0gPSBtZXNzYWdlQXJyYXlba107XG4gICAgdCA9IChyZWYxID0gbS50ZXh0KSAhPSBudWxsID8gcmVmMSA6IG07XG4gICAgbGluZSA9IG5ldyBUZXh0TGF5ZXIoe1xuICAgICAgeDogMTIwLFxuICAgICAgdGV4dEFsaWduOiBcImxlZnRcIixcbiAgICAgIHk6IENhbnZhcy5oZWlnaHQgLSAyNTAgLSBoICogaSxcbiAgICAgIHRleHQ6IHQsXG4gICAgICBjb2xvcjogXCIjMzMzXCIsXG4gICAgICBmb250OiBcIjE0cHgvMS41IEhlbHZldGljYVwiXG4gICAgfSk7XG4gICAgbGluZS5wYXJlbnQgPSBzdHJlYW07XG4gICAgcmVzdWx0cy5wdXNoKGkrKyk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHM7XG59KTtcblxuYnV0dG9uLm9uTW91c2VVcChmdW5jdGlvbigpIHtcbiAgYnV0dG9uLmltYWdlID0gXCJpbWFnZXMvYnV0dG9uLnBuZ1wiO1xuICByZXR1cm4gcG9zdCgpO1xufSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBwb3N0KCk7XG4gICAgcmV0dXJuIHRleHRmaWVsZC52YWx1ZSA9IFwiXCI7XG4gIH1cbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lMMVZ6WlhKekwycGxabVp5WlhrdWFHRnljbWx6TDBSbGRtVnNiM0J0Wlc1MEwyWnlZVzFsY2kxemEyVjBZMmd0Wm1seVpXSmhjMlV0WW05cGJHVnljR3hoZEdVdmMzSmpMMkZ3Y0M1amIyWm1aV1VpTENKemIzVnlZMlZTYjI5MElqb2lJaXdpYzI5MWNtTmxjeUk2V3lJdlZYTmxjbk12YW1WbVpuSmxlUzVvWVhKeWFYTXZSR1YyWld4dmNHMWxiblF2Wm5KaGJXVnlMWE5yWlhSamFDMW1hWEpsWW1GelpTMWliMmxzWlhKd2JHRjBaUzl6Y21NdllYQndMbU52Wm1abFpTSmRMQ0p1WVcxbGN5STZXMTBzSW0xaGNIQnBibWR6SWpvaVFVRkJRU3hKUVVGQk96dEJRVUZCTEVWQlFVRXNSMEZCU3l4UFFVRkJMRU5CUVZFc1VVRkJVanM3UVVGRFNpeHBRa0ZCYTBJc1QwRkJRU3hEUVVGUkxHZENRVUZTT3p0QlFVTnNRaXhSUVVGVExFOUJRVUVzUTBGQlVTeFpRVUZTT3p0QlFVVldMRXRCUVVFc1IwRkJVU3hOUVVGTkxFTkJRVU1zVFVGQlRTeERRVUZET3p0QlFVTjBRaXhOUVVGQkxFZEJRVk1zVFVGQlRTeERRVUZETEUxQlFVMHNRMEZCUXpzN1FVRkZka0lzVlVGQlFTeEhRVUZoT3p0QlFVVmlMRVZCUVVVc1EwRkJReXhQUVVGSUxFTkJRVmNzVVVGQldDeEZRVUZ4UWl4VFFVRkRMRWRCUVVRc1JVRkJUU3hMUVVGT08xTkJRMnBDTEU5QlFVOHNRMEZCUXl4SFFVRlNMRU5CUVZrc1IwRkJXanRCUVVScFFpeERRVUZ5UWpzN1FVRkhRU3hOUVVGTkxFTkJRVU1zVVVGQlVTeERRVUZETEZOQlFXaENMRWRCUTBVN1JVRkJRU3hMUVVGQkxFVkJRVThzYjBKQlFWQTdPenRCUVVWR0xFMUJRVUVzUjBGQlV5eEpRVUZKTEdOQlFVb3NRMEZEVWp0RlFVRkJMRk5CUVVFc1JVRkJWeXcyUWtGQldEdEZRVU5CTEUxQlFVRXNSVUZCVVN3d1EwRkVVanRGUVVWQkxFMUJRVUVzUlVGQlVTeG5RMEZHVWp0RFFVUlJPenRCUVV0VUxFVkJRVUVzUjBGQlN5eEpRVUZKTEdWQlFVb3NRMEZEUkR0RlFVRkJMR1ZCUVVFc1JVRkJhVUlzVTBGQmFrSTdRMEZFUXpzN1FVRkhUQ3hOUVVGQkxFZEJRVk1zU1VGQlNTeExRVUZLTEVOQlEwdzdSVUZCUVN4RFFVRkJMRVZCUVVrc1EwRkJTanRGUVVOQkxFTkJRVUVzUlVGQlNTeE5RVUZOTEVOQlFVTXNUVUZCVUN4SFFVRm5RaXhIUVVSd1FqdEZRVVZCTEV0QlFVRXNSVUZCVHl4TlFVRk5MRU5CUVVNc1MwRkdaRHRGUVVkQkxFMUJRVUVzUlVGQlVTeEhRVWhTTzBWQlNVRXNaVUZCUVN4RlFVRnBRaXhOUVVwcVFqdERRVVJMT3p0QlFVOVVMRTFCUVVFc1IwRkJVeXhKUVVGSkxFdEJRVW9zUTBGRFREdEZRVUZCTEVOQlFVRXNSVUZCUnl4RFFVRklPMFZCUTBFc1EwRkJRU3hGUVVGSExFTkJSRWc3UlVGRlFTeExRVUZCTEVWQlFVOHNUVUZCVFN4RFFVRkRMRXRCUm1RN1JVRkhRU3hOUVVGQkxFVkJRVkVzVFVGQlRTeERRVUZETEUxQlFWQXNSMEZCWjBJc1IwRkllRUk3UlVGSlFTeGxRVUZCTEVWQlFXbENMR0ZCU21wQ08wTkJSRXM3TzBGQlUxUXNUVUZCUVN4SFFVRlRMRWxCUVVrc1MwRkJTaXhEUVVOTU8wVkJRVUVzUTBGQlFTeEZRVUZITEVkQlFVZzdSVUZEUVN4RFFVRkJMRVZCUVVjc1RVRkJUU3hEUVVGRExFMUJRVkFzUjBGQlowSXNSMEZFYmtJN1JVRkZRU3hMUVVGQkxFVkJRVThzUlVGR1VEdEZRVWRCTEUxQlFVRXNSVUZCVVN4RlFVaFNPMFZCU1VFc1MwRkJRU3hGUVVGUExHMUNRVXBRTzBOQlJFczdPMEZCVDFRc1RVRkJUU3hEUVVGRExGZEJRVkFzUTBGQmJVSXNVMEZCUVR0VFFVTm1MRTFCUVUwc1EwRkJReXhMUVVGUUxFZEJRV1U3UVVGRVFTeERRVUZ1UWpzN1FVRkhRU3hMUVVGQkxFZEJRVkVzU1VGQlNTeExRVUZLTEVOQlEwbzdSVUZCUVN4RFFVRkJMRVZCUVVjc1IwRkJTRHRGUVVOQkxFTkJRVUVzUlVGQlJ5eE5RVUZOTEVOQlFVTXNUVUZCVUN4SFFVRm5RaXhIUVVSdVFqdEZRVVZCTEV0QlFVRXNSVUZCVHl4SFFVWlFPMFZCUjBFc1RVRkJRU3hGUVVGUkxFVkJTRkk3UlVGSlFTeExRVUZCTEVWQlFVOHNhMEpCU2xBN1EwRkVTVHM3UVVGUFVpeFRRVUZCTEVkQlFWa3NTVUZCU1N4TFFVRktMRU5CUTFJN1JVRkJRU3hMUVVGQkxFVkJRVThzUzBGQlVEdEZRVU5CTEVsQlFVRXNSVUZCVFN4TlFVUk9PMFZCUlVFc1EwRkJRU3hGUVVGSExFZEJSa2c3UlVGSFFTeERRVUZCTEVWQlFVY3NUVUZCVFN4RFFVRkRMRTFCUVZBc1IwRkJaMElzUjBGSWJrSTdSVUZKUVN4TFFVRkJMRVZCUVU4c1IwRktVRHRGUVV0QkxFMUJRVUVzUlVGQlVTeEZRVXhTTzBOQlJGRTdPMEZCVVZvc1UwRkJVeXhEUVVGRExFdEJRVllzUjBGRFNUdEZRVUZCTEZGQlFVRXNSVUZCVlN4TlFVRldPMFZCUTBFc1MwRkJRU3hGUVVGUExFMUJSRkE3UlVGRlFTeFZRVUZCTEVWQlFWa3NWMEZHV2p0RlFVZEJMRTlCUVVFc1JVRkJVeXh4UWtGSVZEczdPMEZCVDBvc1NVRkJRU3hIUVVGUExGTkJRVUU3UlVGRFNDeEpRVUZITEZOQlFWTXNRMEZCUXl4TFFVRkxMRU5CUVVNc1RVRkJia0k3VjBGRFNTeE5RVUZOTEVOQlFVTXNTVUZCVUN4RFFVRlpMRmRCUVZvc1JVRkJlVUk3VFVGQlF5eE5RVUZCTEVWQlFWRXNVMEZCVXl4RFFVRkRMRXRCUVc1Q08wdEJRWHBDTEVWQlJFbzdPMEZCUkVjN08wRkJaMEpRTEUxQlFVMHNRMEZCUXl4UlFVRlFMRU5CUVdkQ0xGZEJRV2hDTEVWQlFUWkNMRk5CUVVNc1QwRkJSRHRCUVVONlFpeE5RVUZCTzBGQlFVRTdRVUZCUVN4UFFVRkJMSEZEUVVGQk96dEpRVU5KTEV0QlFVc3NRMEZCUXl4UFFVRk9MRU5CUTBrN1RVRkJRU3hEUVVGQkxFVkJRVWNzUzBGQlN5eERRVUZETEVOQlFVNHNSMEZCVlN4VlFVRmlPMHRCUkVvN1FVRkVTanRGUVVkQkxGbEJRVUVzUjBGQlpTeERRVUZETEVOQlFVTXNUMEZCUml4RFFVRlZMRTlCUVZZN1JVRkZaaXhEUVVGQkxFZEJRVWs3UlVGRFNpeERRVUZCTEVkQlFVazdRVUZGU2p0UFFVRkJMRFJEUVVGQk96dEpRVU5KTEVOQlFVRXNiME5CUVdFN1NVRkRZaXhKUVVGQkxFZEJRVThzU1VGQlNTeFRRVUZLTEVOQlEwZzdUVUZCUVN4RFFVRkJMRVZCUVVjc1IwRkJTRHROUVVOQkxGTkJRVUVzUlVGQlZ5eE5RVVJZTzAxQlJVRXNRMEZCUVN4RlFVRkhMRTFCUVUwc1EwRkJReXhOUVVGUUxFZEJRV2RDTEVkQlFXaENMRWRCUVhOQ0xFTkJRVUVzUjBGQlNTeERRVVkzUWp0TlFVZEJMRWxCUVVFc1JVRkJUU3hEUVVoT08wMUJTVUVzUzBGQlFTeEZRVUZQTEUxQlNsQTdUVUZMUVN4SlFVRkJMRVZCUVUwc2IwSkJURTQ3UzBGRVJ6dEpRVTlRTEVsQlFVa3NRMEZCUXl4TlFVRk1MRWRCUVdNN2FVSkJRMlFzUTBGQlFUdEJRVlpLT3p0QlFWUjVRaXhEUVVFM1FqczdRVUZ4UWtFc1RVRkJUU3hEUVVGRExGTkJRVkFzUTBGQmFVSXNVMEZCUVR0RlFVTmlMRTFCUVUwc1EwRkJReXhMUVVGUUxFZEJRV1U3VTBGRFppeEpRVUZCTEVOQlFVRTdRVUZHWVN4RFFVRnFRanM3UVVGSlFTeFJRVUZSTEVOQlFVTXNaMEpCUVZRc1EwRkJNRUlzVlVGQk1VSXNSVUZCYzBNc1UwRkJReXhMUVVGRU8wVkJRMnhETEVsQlFVY3NTMEZCU3l4RFFVRkRMRTlCUVU0c1MwRkJhVUlzUlVGQmNFSTdTVUZEU1N4TFFVRkxMRU5CUVVNc1kwRkJUaXhEUVVGQk8wbEJRMEVzU1VGQlFTeERRVUZCTzFkQlEwRXNVMEZCVXl4RFFVRkRMRXRCUVZZc1IwRkJhMElzUjBGSWRFSTdPMEZCUkd0RExFTkJRWFJESW4wPVxuIiwidmFyIGV4dGVuZCA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoaGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfSxcbiAgaGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5O1xuXG5leHBvcnRzLkZpcmViYXNlRnJhbWVyID0gKGZ1bmN0aW9uKHN1cGVyQ2xhc3MpIHtcbiAgdmFyIGdldENPUlN1cmwsIHJlcXVlc3Q7XG5cbiAgZXh0ZW5kKEZpcmViYXNlRnJhbWVyLCBzdXBlckNsYXNzKTtcblxuICBnZXRDT1JTdXJsID0gZnVuY3Rpb24oc2VydmVyLCBwYXRoLCBzZWNyZXQsIHByb2plY3QpIHtcbiAgICB2YXIgdXJsO1xuICAgIHN3aXRjaCAoVXRpbHMuaXNXZWJLaXQoKSkge1xuICAgICAgY2FzZSB0cnVlOlxuICAgICAgICB1cmwgPSBcImh0dHBzOi8vXCIgKyBzZXJ2ZXIgKyBwYXRoICsgXCIuanNvbj9hdXRoPVwiICsgc2VjcmV0ICsgXCImbnM9XCIgKyBwcm9qZWN0ICsgXCImc3NlPXRydWVcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB1cmwgPSBcImh0dHBzOi8vXCIgKyBwcm9qZWN0ICsgXCIuZmlyZWJhc2Vpby5jb21cIiArIHBhdGggKyBcIi5qc29uP2F1dGg9XCIgKyBzZWNyZXQ7XG4gICAgfVxuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgRmlyZWJhc2VGcmFtZXIuZGVmaW5lKFwic3RhdHVzXCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1cztcbiAgICB9XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIEZpcmViYXNlRnJhbWVyKG9wdGlvbnMpIHtcbiAgICB2YXIgYmFzZSwgYmFzZTEsIGJhc2UyLCBiYXNlMztcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zICE9IG51bGwgPyBvcHRpb25zIDoge307XG4gICAgdGhpcy5wcm9qZWN0SUQgPSAoYmFzZSA9IHRoaXMub3B0aW9ucykucHJvamVjdElEICE9IG51bGwgPyBiYXNlLnByb2plY3RJRCA6IGJhc2UucHJvamVjdElEID0gbnVsbDtcbiAgICB0aGlzLnNlY3JldCA9IChiYXNlMSA9IHRoaXMub3B0aW9ucykuc2VjcmV0ICE9IG51bGwgPyBiYXNlMS5zZWNyZXQgOiBiYXNlMS5zZWNyZXQgPSBudWxsO1xuICAgIHRoaXMuc2VydmVyID0gKGJhc2UyID0gdGhpcy5vcHRpb25zKS5zZXJ2ZXIgIT0gbnVsbCA/IGJhc2UyLnNlcnZlciA6IGJhc2UyLnNlcnZlciA9IHZvaWQgMDtcbiAgICB0aGlzLmRlYnVnID0gKGJhc2UzID0gdGhpcy5vcHRpb25zKS5kZWJ1ZyAhPSBudWxsID8gYmFzZTMuZGVidWcgOiBiYXNlMy5kZWJ1ZyA9IGZhbHNlO1xuICAgIGlmICh0aGlzLl9zdGF0dXMgPT0gbnVsbCkge1xuICAgICAgdGhpcy5fc3RhdHVzID0gXCJkaXNjb25uZWN0ZWRcIjtcbiAgICB9XG4gICAgRmlyZWJhc2VGcmFtZXIuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKHRoaXMuc2VydmVyID09PSB2b2lkIDApIHtcbiAgICAgIFV0aWxzLmRvbUxvYWRKU09OKFwiaHR0cHM6Ly9cIiArIHRoaXMucHJvamVjdElEICsgXCIuZmlyZWJhc2Vpby5jb20vLnNldHRpbmdzL293bmVyLmpzb25cIiwgZnVuY3Rpb24oYSwgc2VydmVyKSB7XG4gICAgICAgIHZhciBtc2c7XG4gICAgICAgIHByaW50KG1zZyA9IFwiQWRkIF9fX19fXyBzZXJ2ZXI6XCIgKyAnICAgXCInICsgc2VydmVyICsgJ1wiJyArIFwiIF9fX19fIHRvIHlvdXIgaW5zdGFuY2Ugb2YgRmlyZWJhc2UuXCIpO1xuICAgICAgICBpZiAodGhpcy5kZWJ1Zykge1xuICAgICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhcIkZpcmViYXNlOiBcIiArIG1zZyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAodGhpcy5kZWJ1Zykge1xuICAgICAgY29uc29sZS5sb2coXCJGaXJlYmFzZTogQ29ubmVjdGluZyB0byBGaXJlYmFzZSBQcm9qZWN0ICdcIiArIHRoaXMucHJvamVjdElEICsgXCInIC4uLiBcXG4gVVJMOiAnXCIgKyAoZ2V0Q09SU3VybCh0aGlzLnNlcnZlciwgXCIvXCIsIHRoaXMuc2VjcmV0LCB0aGlzLnByb2plY3RJRCkpICsgXCInXCIpO1xuICAgIH1cbiAgICB0aGlzLm9uQ2hhbmdlKFwiY29ubmVjdGlvblwiKTtcbiAgfVxuXG4gIHJlcXVlc3QgPSBmdW5jdGlvbihwcm9qZWN0LCBzZWNyZXQsIHBhdGgsIGNhbGxiYWNrLCBtZXRob2QsIGRhdGEsIHBhcmFtZXRlcnMsIGRlYnVnKSB7XG4gICAgdmFyIHVybCwgeGh0dHA7XG4gICAgdXJsID0gXCJodHRwczovL1wiICsgcHJvamVjdCArIFwiLmZpcmViYXNlaW8uY29tXCIgKyBwYXRoICsgXCIuanNvbj9hdXRoPVwiICsgc2VjcmV0O1xuICAgIGlmIChwYXJhbWV0ZXJzICE9PSB2b2lkIDApIHtcbiAgICAgIGlmIChwYXJhbWV0ZXJzLnNoYWxsb3cpIHtcbiAgICAgICAgdXJsICs9IFwiJnNoYWxsb3c9dHJ1ZVwiO1xuICAgICAgfVxuICAgICAgaWYgKHBhcmFtZXRlcnMuZm9ybWF0ID09PSBcImV4cG9ydFwiKSB7XG4gICAgICAgIHVybCArPSBcIiZmb3JtYXQ9ZXhwb3J0XCI7XG4gICAgICB9XG4gICAgICBzd2l0Y2ggKHBhcmFtZXRlcnMucHJpbnQpIHtcbiAgICAgICAgY2FzZSBcInByZXR0eVwiOlxuICAgICAgICAgIHVybCArPSBcIiZwcmludD1wcmV0dHlcIjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcInNpbGVudFwiOlxuICAgICAgICAgIHVybCArPSBcIiZwcmludD1zaWxlbnRcIjtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgcGFyYW1ldGVycy5kb3dubG9hZCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB1cmwgKz0gXCImZG93bmxvYWQ9XCIgKyBwYXJhbWV0ZXJzLmRvd25sb2FkO1xuICAgICAgICB3aW5kb3cub3Blbih1cmwsIFwiX3NlbGZcIik7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHBhcmFtZXRlcnMub3JkZXJCeSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB1cmwgKz0gXCImb3JkZXJCeT1cIiArICdcIicgKyBwYXJhbWV0ZXJzLm9yZGVyQnkgKyAnXCInO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBwYXJhbWV0ZXJzLmxpbWl0VG9GaXJzdCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICB1cmwgKz0gXCImbGltaXRUb0ZpcnN0PVwiICsgcGFyYW1ldGVycy5saW1pdFRvRmlyc3Q7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHBhcmFtZXRlcnMubGltaXRUb0xhc3QgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgdXJsICs9IFwiJmxpbWl0VG9MYXN0PVwiICsgcGFyYW1ldGVycy5saW1pdFRvTGFzdDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgcGFyYW1ldGVycy5zdGFydEF0ID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHVybCArPSBcIiZzdGFydEF0PVwiICsgcGFyYW1ldGVycy5zdGFydEF0O1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBwYXJhbWV0ZXJzLmVuZEF0ID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHVybCArPSBcIiZlbmRBdD1cIiArIHBhcmFtZXRlcnMuZW5kQXQ7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHBhcmFtZXRlcnMuZXF1YWxUbyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICB1cmwgKz0gXCImZXF1YWxUbz1cIiArIHBhcmFtZXRlcnMuZXF1YWxUbztcbiAgICAgIH1cbiAgICB9XG4gICAgeGh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3Q7XG4gICAgaWYgKGRlYnVnKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkZpcmViYXNlOiBOZXcgJ1wiICsgbWV0aG9kICsgXCInLXJlcXVlc3Qgd2l0aCBkYXRhOiAnXCIgKyAoSlNPTi5zdHJpbmdpZnkoZGF0YSkpICsgXCInIFxcbiBVUkw6ICdcIiArIHVybCArIFwiJ1wiKTtcbiAgICB9XG4gICAgeGh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gKGZ1bmN0aW9uKF90aGlzKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzICE9PSB2b2lkIDApIHtcbiAgICAgICAgICBpZiAocGFyYW1ldGVycy5wcmludCA9PT0gXCJzaWxlbnRcIiB8fCB0eXBlb2YgcGFyYW1ldGVycy5kb3dubG9hZCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHhodHRwLnJlYWR5U3RhdGUpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBpZiAoZGVidWcpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJGaXJlYmFzZTogUmVxdWVzdCBub3QgaW5pdGlhbGl6ZWQgXFxuIFVSTDogJ1wiICsgdXJsICsgXCInXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgaWYgKGRlYnVnKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRmlyZWJhc2U6IFNlcnZlciBjb25uZWN0aW9uIGVzdGFibGlzaGVkIFxcbiBVUkw6ICdcIiArIHVybCArIFwiJ1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGlmIChkZWJ1Zykge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZpcmViYXNlOiBSZXF1ZXN0IHJlY2VpdmVkIFxcbiBVUkw6ICdcIiArIHVybCArIFwiJ1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIGlmIChkZWJ1Zykge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZpcmViYXNlOiBQcm9jZXNzaW5nIHJlcXVlc3QgXFxuIFVSTDogJ1wiICsgdXJsICsgXCInXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgY2FsbGJhY2soSlNPTi5wYXJzZSh4aHR0cC5yZXNwb25zZVRleHQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkZWJ1Zykge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZpcmViYXNlOiBSZXF1ZXN0IGZpbmlzaGVkLCByZXNwb25zZTogJ1wiICsgKEpTT04ucGFyc2UoeGh0dHAucmVzcG9uc2VUZXh0KSkgKyBcIicgXFxuIFVSTDogJ1wiICsgdXJsICsgXCInXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh4aHR0cC5zdGF0dXMgPT09IFwiNDA0XCIpIHtcbiAgICAgICAgICBpZiAoZGVidWcpIHtcbiAgICAgICAgICAgIHJldHVybiBjb25zb2xlLndhcm4oXCJGaXJlYmFzZTogSW52YWxpZCByZXF1ZXN0LCBwYWdlIG5vdCBmb3VuZCBcXG4gVVJMOiAnXCIgKyB1cmwgKyBcIidcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0pKHRoaXMpO1xuICAgIHhodHRwLm9wZW4obWV0aG9kLCB1cmwsIHRydWUpO1xuICAgIHhodHRwLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LXR5cGVcIiwgXCJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04XCIpO1xuICAgIHJldHVybiB4aHR0cC5zZW5kKGRhdGEgPSBcIlwiICsgKEpTT04uc3RyaW5naWZ5KGRhdGEpKSk7XG4gIH07XG5cbiAgRmlyZWJhc2VGcmFtZXIucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKHBhdGgsIGNhbGxiYWNrLCBwYXJhbWV0ZXJzKSB7XG4gICAgcmV0dXJuIHJlcXVlc3QodGhpcy5wcm9qZWN0SUQsIHRoaXMuc2VjcmV0LCBwYXRoLCBjYWxsYmFjaywgXCJHRVRcIiwgbnVsbCwgcGFyYW1ldGVycywgdGhpcy5kZWJ1Zyk7XG4gIH07XG5cbiAgRmlyZWJhc2VGcmFtZXIucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uKHBhdGgsIGRhdGEsIGNhbGxiYWNrLCBwYXJhbWV0ZXJzKSB7XG4gICAgcmV0dXJuIHJlcXVlc3QodGhpcy5wcm9qZWN0SUQsIHRoaXMuc2VjcmV0LCBwYXRoLCBjYWxsYmFjaywgXCJQVVRcIiwgZGF0YSwgcGFyYW1ldGVycywgdGhpcy5kZWJ1Zyk7XG4gIH07XG5cbiAgRmlyZWJhc2VGcmFtZXIucHJvdG90eXBlLnBvc3QgPSBmdW5jdGlvbihwYXRoLCBkYXRhLCBjYWxsYmFjaywgcGFyYW1ldGVycykge1xuICAgIHJldHVybiByZXF1ZXN0KHRoaXMucHJvamVjdElELCB0aGlzLnNlY3JldCwgcGF0aCwgY2FsbGJhY2ssIFwiUE9TVFwiLCBkYXRhLCBwYXJhbWV0ZXJzLCB0aGlzLmRlYnVnKTtcbiAgfTtcblxuICBGaXJlYmFzZUZyYW1lci5wcm90b3R5cGUucGF0Y2ggPSBmdW5jdGlvbihwYXRoLCBkYXRhLCBjYWxsYmFjaywgcGFyYW1ldGVycykge1xuICAgIHJldHVybiByZXF1ZXN0KHRoaXMucHJvamVjdElELCB0aGlzLnNlY3JldCwgcGF0aCwgY2FsbGJhY2ssIFwiUEFUQ0hcIiwgZGF0YSwgcGFyYW1ldGVycywgdGhpcy5kZWJ1Zyk7XG4gIH07XG5cbiAgRmlyZWJhc2VGcmFtZXIucHJvdG90eXBlW1wiZGVsZXRlXCJdID0gZnVuY3Rpb24ocGF0aCwgY2FsbGJhY2ssIHBhcmFtZXRlcnMpIHtcbiAgICByZXR1cm4gcmVxdWVzdCh0aGlzLnByb2plY3RJRCwgdGhpcy5zZWNyZXQsIHBhdGgsIGNhbGxiYWNrLCBcIkRFTEVURVwiLCBudWxsLCBwYXJhbWV0ZXJzLCB0aGlzLmRlYnVnKTtcbiAgfTtcblxuICBGaXJlYmFzZUZyYW1lci5wcm90b3R5cGUub25DaGFuZ2UgPSBmdW5jdGlvbihwYXRoLCBjYWxsYmFjaykge1xuICAgIHZhciBjdXJyZW50U3RhdHVzLCBzb3VyY2UsIHVybDtcbiAgICBpZiAocGF0aCA9PT0gXCJjb25uZWN0aW9uXCIpIHtcbiAgICAgIHVybCA9IGdldENPUlN1cmwodGhpcy5zZXJ2ZXIsIFwiL1wiLCB0aGlzLnNlY3JldCwgdGhpcy5wcm9qZWN0SUQpO1xuICAgICAgY3VycmVudFN0YXR1cyA9IFwiZGlzY29ubmVjdGVkXCI7XG4gICAgICBzb3VyY2UgPSBuZXcgRXZlbnRTb3VyY2UodXJsKTtcbiAgICAgIHNvdXJjZS5hZGRFdmVudExpc3RlbmVyKFwib3BlblwiLCAoZnVuY3Rpb24oX3RoaXMpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmIChjdXJyZW50U3RhdHVzID09PSBcImRpc2Nvbm5lY3RlZFwiKSB7XG4gICAgICAgICAgICBfdGhpcy5fc3RhdHVzID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIGNhbGxiYWNrKFwiY29ubmVjdGVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF90aGlzLmRlYnVnKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRmlyZWJhc2U6IENvbm5lY3Rpb24gdG8gRmlyZWJhc2UgUHJvamVjdCAnXCIgKyBfdGhpcy5wcm9qZWN0SUQgKyBcIicgZXN0YWJsaXNoZWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjdXJyZW50U3RhdHVzID0gXCJjb25uZWN0ZWRcIjtcbiAgICAgICAgfTtcbiAgICAgIH0pKHRoaXMpKTtcbiAgICAgIHJldHVybiBzb3VyY2UuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIChmdW5jdGlvbihfdGhpcykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKGN1cnJlbnRTdGF0dXMgPT09IFwiY29ubmVjdGVkXCIpIHtcbiAgICAgICAgICAgIF90aGlzLl9zdGF0dXMgPSBcImRpc2Nvbm5lY3RlZFwiO1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgY2FsbGJhY2soXCJkaXNjb25uZWN0ZWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoX3RoaXMuZGVidWcpIHtcbiAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiRmlyZWJhc2U6IENvbm5lY3Rpb24gdG8gRmlyZWJhc2UgUHJvamVjdCAnXCIgKyBfdGhpcy5wcm9qZWN0SUQgKyBcIicgY2xvc2VkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3VycmVudFN0YXR1cyA9IFwiZGlzY29ubmVjdGVkXCI7XG4gICAgICAgIH07XG4gICAgICB9KSh0aGlzKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVybCA9IGdldENPUlN1cmwodGhpcy5zZXJ2ZXIsIHBhdGgsIHRoaXMuc2VjcmV0LCB0aGlzLnByb2plY3RJRCk7XG4gICAgICBzb3VyY2UgPSBuZXcgRXZlbnRTb3VyY2UodXJsKTtcbiAgICAgIGlmICh0aGlzLmRlYnVnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRmlyZWJhc2U6IExpc3RlbmluZyB0byBjaGFuZ2VzIG1hZGUgdG8gJ1wiICsgcGF0aCArIFwiJyBcXG4gVVJMOiAnXCIgKyB1cmwgKyBcIidcIik7XG4gICAgICB9XG4gICAgICBzb3VyY2UuYWRkRXZlbnRMaXN0ZW5lcihcInB1dFwiLCAoZnVuY3Rpb24oX3RoaXMpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKEpTT04ucGFyc2UoZXYuZGF0YSkuZGF0YSwgXCJwdXRcIiwgSlNPTi5wYXJzZShldi5kYXRhKS5wYXRjaCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChfdGhpcy5kZWJ1Zykge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKFwiRmlyZWJhc2U6IFJlY2VpdmVkIGNoYW5nZXMgbWFkZSB0byAnXCIgKyBwYXRoICsgXCInIHZpYSAnUFVUJzogXCIgKyAoSlNPTi5wYXJzZShldi5kYXRhKS5kYXRhKSArIFwiIFxcbiBVUkw6ICdcIiArIHVybCArIFwiJ1wiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KSh0aGlzKSk7XG4gICAgICByZXR1cm4gc291cmNlLmFkZEV2ZW50TGlzdGVuZXIoXCJwYXRjaFwiLCAoZnVuY3Rpb24oX3RoaXMpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKEpTT04ucGFyc2UoZXYuZGF0YSkuZGF0YSwgXCJwYXRjaFwiLCBKU09OLnBhcnNlKGV2LmRhdGEpLnBhdGNoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKF90aGlzLmRlYnVnKSB7XG4gICAgICAgICAgICByZXR1cm4gY29uc29sZS5sb2coXCJGaXJlYmFzZTogUmVjZWl2ZWQgY2hhbmdlcyBtYWRlIHRvICdcIiArIHBhdGggKyBcIicgdmlhICdQQVRDSCc6IFwiICsgKEpTT04ucGFyc2UoZXYuZGF0YSkuZGF0YSkgKyBcIiBcXG4gVVJMOiAnXCIgKyB1cmwgKyBcIidcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSkodGhpcykpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gRmlyZWJhc2VGcmFtZXI7XG5cbn0pKEZyYW1lci5CYXNlQ2xhc3MpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lMMVZ6WlhKekwycGxabVp5WlhrdWFHRnljbWx6TDBSbGRtVnNiM0J0Wlc1MEwyWnlZVzFsY2kxemEyVjBZMmd0Wm1seVpXSmhjMlV0WW05cGJHVnljR3hoZEdVdmMzSmpMMjF2WkhWc1pYTXZabWx5WldKaGMyVm1jbUZ0WlhJdVkyOW1abVZsSWl3aWMyOTFjbU5sVW05dmRDSTZJaUlzSW5OdmRYSmpaWE1pT2xzaUwxVnpaWEp6TDJwbFptWnlaWGt1YUdGeWNtbHpMMFJsZG1Wc2IzQnRaVzUwTDJaeVlXMWxjaTF6YTJWMFkyZ3RabWx5WldKaGMyVXRZbTlwYkdWeWNHeGhkR1V2YzNKakwyMXZaSFZzWlhNdlptbHlaV0poYzJWbWNtRnRaWEl1WTI5bVptVmxJbDBzSW01aGJXVnpJanBiWFN3aWJXRndjR2x1WjNNaU9pSkJRV2xDUVN4SlFVRkJPenM3UVVGQlRTeFBRVUZQTEVOQlFVTTdRVUZKWWl4TlFVRkJPenM3TzBWQlFVRXNWVUZCUVN4SFFVRmhMRk5CUVVNc1RVRkJSQ3hGUVVGVExFbEJRVlFzUlVGQlpTeE5RVUZtTEVWQlFYVkNMRTlCUVhaQ08wRkJSVm9zVVVGQlFUdEJRVUZCTEZsQlFVOHNTMEZCU3l4RFFVRkRMRkZCUVU0c1EwRkJRU3hEUVVGUU8wRkJRVUVzVjBGRFRTeEpRVVJPTzFGQlEyZENMRWRCUVVFc1IwRkJUU3hWUVVGQkxFZEJRVmNzVFVGQldDeEhRVUZ2UWl4SlFVRndRaXhIUVVGNVFpeGhRVUY2UWl4SFFVRnpReXhOUVVGMFF5eEhRVUUyUXl4TlFVRTNReXhIUVVGdFJDeFBRVUZ1UkN4SFFVRXlSRHRCUVVFelJUdEJRVVJPTzFGQlJXZENMRWRCUVVFc1IwRkJUU3hWUVVGQkxFZEJRVmNzVDBGQldDeEhRVUZ0UWl4cFFrRkJia0lzUjBGQmIwTXNTVUZCY0VNc1IwRkJlVU1zWVVGQmVrTXNSMEZCYzBRN1FVRkdOVVU3UVVGSlFTeFhRVUZQTzBWQlRrczdPMFZCVTJJc1kwRkJReXhEUVVGRExFMUJRVVlzUTBGQlV5eFJRVUZVTEVWQlEwTTdTVUZCUVN4SFFVRkJMRVZCUVVzc1UwRkJRVHRoUVVGSExFbEJRVU1zUTBGQlFUdEpRVUZLTEVOQlFVdzdSMEZFUkRzN1JVRkhZU3gzUWtGQlF5eFBRVUZFTzBGQlExb3NVVUZCUVR0SlFVUmhMRWxCUVVNc1EwRkJRU3cwUWtGQlJDeFZRVUZUTzBsQlEzUkNMRWxCUVVNc1EwRkJRU3hUUVVGRUxHbEVRVUZ4UWl4RFFVRkRMR2RDUVVGRUxFTkJRVU1zV1VGQllUdEpRVU51UXl4SlFVRkRMRU5CUVVFc1RVRkJSQ3huUkVGQmNVSXNRMEZCUXl4alFVRkVMRU5CUVVNc1UwRkJZVHRKUVVOdVF5eEpRVUZETEVOQlFVRXNUVUZCUkN4blJFRkJjVUlzUTBGQlF5eGpRVUZFTEVOQlFVTXNVMEZCWVR0SlFVTnVReXhKUVVGRExFTkJRVUVzUzBGQlJDd3JRMEZCY1VJc1EwRkJReXhoUVVGRUxFTkJRVU1zVVVGQllUczdUVUZEYmtNc1NVRkJReXhEUVVGQkxGVkJRV3RET3p0SlFVTnVReXhwUkVGQlFTeFRRVUZCTzBsQlIwRXNTVUZCUnl4SlFVRkRMRU5CUVVFc1RVRkJSQ3hMUVVGWExFMUJRV1E3VFVGRFF5eExRVUZMTEVOQlFVTXNWMEZCVGl4RFFVRnJRaXhWUVVGQkxFZEJRVmNzU1VGQlF5eERRVUZCTEZOQlFWb3NSMEZCYzBJc2MwTkJRWGhETEVWQlFTdEZMRk5CUVVNc1EwRkJSQ3hGUVVGSExFMUJRVWc3UVVGRE9VVXNXVUZCUVR0UlFVRkJMRXRCUVVFc1EwRkJUU3hIUVVGQkxFZEJRVTBzYjBKQlFVRXNSMEZCZFVJc1RVRkJka0lzUjBGQlowTXNUVUZCYUVNc1IwRkJlVU1zUjBGQmVrTXNSMEZCSzBNc2MwTkJRVE5FTzFGQlEwRXNTVUZCYTBNc1NVRkJReXhEUVVGQkxFdEJRVzVETzJsQ1FVRkJMRTlCUVU4c1EwRkJReXhIUVVGU0xFTkJRVmtzV1VGQlFTeEhRVUZoTEVkQlFYcENMRVZCUVVFN08wMUJSamhGTEVOQlFTOUZMRVZCUkVRN08wbEJUVUVzU1VGQmVVa3NTVUZCUXl4RFFVRkJMRXRCUVRGSk8wMUJRVUVzVDBGQlR5eERRVUZETEVkQlFWSXNRMEZCV1N3MFEwRkJRU3hIUVVFMlF5eEpRVUZETEVOQlFVRXNVMEZCT1VNc1IwRkJkMFFzYVVKQlFYaEVMRWRCUVhkRkxFTkJRVU1zVlVGQlFTeERRVUZYTEVsQlFVTXNRMEZCUVN4TlFVRmFMRVZCUVc5Q0xFZEJRWEJDTEVWQlFYbENMRWxCUVVNc1EwRkJRU3hOUVVFeFFpeEZRVUZyUXl4SlFVRkRMRU5CUVVFc1UwRkJia01zUTBGQlJDeERRVUY0UlN4SFFVRjFTQ3hIUVVGdVNTeEZRVUZCT3p0SlFVTkJMRWxCUVVNc1EwRkJReXhSUVVGR0xFTkJRVmNzV1VGQldEdEZRV2hDV1RzN1JVRnRRbUlzVDBGQlFTeEhRVUZWTEZOQlFVTXNUMEZCUkN4RlFVRlZMRTFCUVZZc1JVRkJhMElzU1VGQmJFSXNSVUZCZDBJc1VVRkJlRUlzUlVGQmEwTXNUVUZCYkVNc1JVRkJNRU1zU1VGQk1VTXNSVUZCWjBRc1ZVRkJhRVFzUlVGQk5FUXNTMEZCTlVRN1FVRkZWQ3hSUVVGQk8wbEJRVUVzUjBGQlFTeEhRVUZOTEZWQlFVRXNSMEZCVnl4UFFVRllMRWRCUVcxQ0xHbENRVUZ1UWl4SFFVRnZReXhKUVVGd1F5eEhRVUY1UXl4aFFVRjZReXhIUVVGelJEdEpRVWMxUkN4SlFVRlBMRlZCUVVFc1MwRkJZeXhOUVVGeVFqdE5RVU5ETEVsQlFVY3NWVUZCVlN4RFFVRkRMRTlCUVdRN1VVRkJjME1zUjBGQlFTeEpRVUZQTEdkQ1FVRTNRenM3VFVGRFFTeEpRVUZITEZWQlFWVXNRMEZCUXl4TlFVRllMRXRCUVhGQ0xGRkJRWGhDTzFGQlFYTkRMRWRCUVVFc1NVRkJUeXhwUWtGQk4wTTdPMEZCUlVFc1kwRkJUeXhWUVVGVkxFTkJRVU1zUzBGQmJFSTdRVUZCUVN4aFFVTk5MRkZCUkU0N1ZVRkRiMElzUjBGQlFTeEpRVUZQTzBGQlFYSkNPMEZCUkU0c1lVRkZUU3hSUVVaT08xVkJSVzlDTEVkQlFVRXNTVUZCVHp0QlFVWXpRanROUVVsQkxFbEJRVWNzVDBGQlR5eFZRVUZWTEVOQlFVTXNVVUZCYkVJc1MwRkJPRUlzVVVGQmFrTTdVVUZEUXl4SFFVRkJMRWxCUVU4c1dVRkJRU3hIUVVGaExGVkJRVlVzUTBGQlF6dFJRVU12UWl4TlFVRk5MRU5CUVVNc1NVRkJVQ3hEUVVGWkxFZEJRVm9zUlVGQlowSXNUMEZCYUVJc1JVRkdSRHM3VFVGTFFTeEpRVUYxUkN4UFFVRlBMRlZCUVZVc1EwRkJReXhQUVVGc1FpeExRVUZyUXl4UlFVRjZSanRSUVVGQkxFZEJRVUVzU1VGQlR5eFhRVUZCTEVkQlFXTXNSMEZCWkN4SFFVRnZRaXhWUVVGVkxFTkJRVU1zVDBGQkwwSXNSMEZCZVVNc1NVRkJhRVE3TzAxQlEwRXNTVUZCZFVRc1QwRkJUeXhWUVVGVkxFTkJRVU1zV1VGQmJFSXNTMEZCYTBNc1VVRkJla1k3VVVGQlFTeEhRVUZCTEVsQlFVOHNaMEpCUVVFc1IwRkJhVUlzVlVGQlZTeERRVUZETEdGQlFXNURPenROUVVOQkxFbEJRWFZFTEU5QlFVOHNWVUZCVlN4RFFVRkRMRmRCUVd4Q0xFdEJRV3RETEZGQlFYcEdPMUZCUVVFc1IwRkJRU3hKUVVGUExHVkJRVUVzUjBGQlowSXNWVUZCVlN4RFFVRkRMRmxCUVd4RE96dE5RVU5CTEVsQlFYVkVMRTlCUVU4c1ZVRkJWU3hEUVVGRExFOUJRV3hDTEV0QlFXdERMRkZCUVhwR08xRkJRVUVzUjBGQlFTeEpRVUZQTEZkQlFVRXNSMEZCV1N4VlFVRlZMRU5CUVVNc1VVRkJPVUk3TzAxQlEwRXNTVUZCZFVRc1QwRkJUeXhWUVVGVkxFTkJRVU1zUzBGQmJFSXNTMEZCYTBNc1VVRkJla1k3VVVGQlFTeEhRVUZCTEVsQlFVOHNVMEZCUVN4SFFVRlZMRlZCUVZVc1EwRkJReXhOUVVFMVFqczdUVUZEUVN4SlFVRjFSQ3hQUVVGUExGVkJRVlVzUTBGQlF5eFBRVUZzUWl4TFFVRnJReXhSUVVGNlJqdFJRVUZCTEVkQlFVRXNTVUZCVHl4WFFVRkJMRWRCUVZrc1ZVRkJWU3hEUVVGRExGRkJRVGxDTzA5QmJFSkVPenRKUVhGQ1FTeExRVUZCTEVkQlFWRXNTVUZCU1R0SlFVTmFMRWxCUVhsSExFdEJRWHBITzAxQlFVRXNUMEZCVHl4RFFVRkRMRWRCUVZJc1EwRkJXU3hwUWtGQlFTeEhRVUZyUWl4TlFVRnNRaXhIUVVGNVFpeDNRa0ZCZWtJc1IwRkJaMFFzUTBGQlF5eEpRVUZKTEVOQlFVTXNVMEZCVEN4RFFVRmxMRWxCUVdZc1EwRkJSQ3hEUVVGb1JDeEhRVUZ6UlN4aFFVRjBSU3hIUVVGdFJpeEhRVUZ1Uml4SFFVRjFSaXhIUVVGdVJ5eEZRVUZCT3p0SlFVTkJMRXRCUVVzc1EwRkJReXhyUWtGQlRpeEhRVUV5UWl4RFFVRkJMRk5CUVVFc1MwRkJRVHRoUVVGQkxGTkJRVUU3VVVGRk1VSXNTVUZCVHl4VlFVRkJMRXRCUVdNc1RVRkJja0k3VlVGRFF5eEpRVUZITEZWQlFWVXNRMEZCUXl4TFFVRllMRXRCUVc5Q0xGRkJRWEJDTEVsQlFXZERMRTlCUVU4c1ZVRkJWU3hEUVVGRExGRkJRV3hDTEV0QlFUaENMRkZCUVdwRk8wRkJRU3RGTEcxQ1FVRXZSVHRYUVVSRU96dEJRVWRCTEdkQ1FVRlBMRXRCUVVzc1EwRkJReXhWUVVGaU8wRkJRVUVzWlVGRFRTeERRVVJPTzFsQlEyRXNTVUZCTUVVc1MwRkJNVVU3WTBGQlFTeFBRVUZQTEVOQlFVTXNSMEZCVWl4RFFVRlpMRFpEUVVGQkxFZEJRVGhETEVkQlFUbERMRWRCUVd0RUxFZEJRVGxFTEVWQlFVRTdPMEZCUVZBN1FVRkVUaXhsUVVWTkxFTkJSazQ3V1VGRllTeEpRVUV3UlN4TFFVRXhSVHRqUVVGQkxFOUJRVThzUTBGQlF5eEhRVUZTTEVOQlFWa3NiVVJCUVVFc1IwRkJiMFFzUjBGQmNFUXNSMEZCZDBRc1IwRkJjRVVzUlVGQlFUczdRVUZCVUR0QlFVWk9MR1ZCUjAwc1EwRklUanRaUVVkaExFbEJRVEJGTEV0QlFURkZPMk5CUVVFc1QwRkJUeXhEUVVGRExFZEJRVklzUTBGQldTeHpRMEZCUVN4SFFVRjFReXhIUVVGMlF5eEhRVUV5UXl4SFFVRjJSQ3hGUVVGQk96dEJRVUZRTzBGQlNFNHNaVUZKVFN4RFFVcE9PMWxCU1dFc1NVRkJNRVVzUzBGQk1VVTdZMEZCUVN4UFFVRlBMRU5CUVVNc1IwRkJVaXhEUVVGWkxIZERRVUZCTEVkQlFYbERMRWRCUVhwRExFZEJRVFpETEVkQlFYcEVMRVZCUVVFN08wRkJRVkE3UVVGS1RpeGxRVXROTEVOQlRFNDdXVUZOUlN4SlFVRTBReXhuUWtGQk5VTTdZMEZCUVN4UlFVRkJMRU5CUVZNc1NVRkJTU3hEUVVGRExFdEJRVXdzUTBGQlZ5eExRVUZMTEVOQlFVTXNXVUZCYWtJc1EwRkJWQ3hGUVVGQk96dFpRVU5CTEVsQlFUUkhMRXRCUVRWSE8yTkJRVUVzVDBGQlR5eERRVUZETEVkQlFWSXNRMEZCV1N4NVEwRkJRU3hIUVVGNVF5eERRVUZETEVsQlFVa3NRMEZCUXl4TFFVRk1MRU5CUVZjc1MwRkJTeXhEUVVGRExGbEJRV3BDTEVOQlFVUXNRMEZCZWtNc1IwRkJlVVVzWVVGQmVrVXNSMEZCYzBZc1IwRkJkRVlzUjBGQk1FWXNSMEZCZEVjc1JVRkJRVHM3UVVGUVJqdFJRVk5CTEVsQlFVY3NTMEZCU3l4RFFVRkRMRTFCUVU0c1MwRkJaMElzUzBGQmJrSTdWVUZEUXl4SlFVRTJSU3hMUVVFM1JUdHRRa0ZCUVN4UFFVRlBMRU5CUVVNc1NVRkJVaXhEUVVGaExIRkVRVUZCTEVkQlFYTkVMRWRCUVhSRUxFZEJRVEJFTEVkQlFYWkZMRVZCUVVFN1YwRkVSRHM3VFVGa01FSTdTVUZCUVN4RFFVRkJMRU5CUVVFc1EwRkJRU3hKUVVGQk8wbEJhMEl6UWl4TFFVRkxMRU5CUVVNc1NVRkJUaXhEUVVGWExFMUJRVmdzUlVGQmJVSXNSMEZCYmtJc1JVRkJkMElzU1VGQmVFSTdTVUZEUVN4TFFVRkxMRU5CUVVNc1owSkJRVTRzUTBGQmRVSXNZMEZCZGtJc1JVRkJkVU1zYVVOQlFYWkRPMWRCUTBFc1MwRkJTeXhEUVVGRExFbEJRVTRzUTBGQlZ5eEpRVUZCTEVkQlFVOHNSVUZCUVN4SFFVRkZMRU5CUVVNc1NVRkJTU3hEUVVGRExGTkJRVXdzUTBGQlpTeEpRVUZtTEVOQlFVUXNRMEZCY0VJN1JVRm9SRk03T3pKQ1FYTkVWaXhIUVVGQkxFZEJRVkVzVTBGQlF5eEpRVUZFTEVWQlFVOHNVVUZCVUN4RlFVRjFRaXhWUVVGMlFqdFhRVUZ6UXl4UFFVRkJMRU5CUVZFc1NVRkJReXhEUVVGQkxGTkJRVlFzUlVGQmIwSXNTVUZCUXl4RFFVRkJMRTFCUVhKQ0xFVkJRVFpDTEVsQlFUZENMRVZCUVcxRExGRkJRVzVETEVWQlFUWkRMRXRCUVRkRExFVkJRWFZFTEVsQlFYWkVMRVZCUVRaRUxGVkJRVGRFTEVWQlFYbEZMRWxCUVVNc1EwRkJRU3hMUVVFeFJUdEZRVUYwUXpzN01rSkJRMUlzUjBGQlFTeEhRVUZSTEZOQlFVTXNTVUZCUkN4RlFVRlBMRWxCUVZBc1JVRkJZU3hSUVVGaUxFVkJRWFZDTEZWQlFYWkNPMWRCUVhORExFOUJRVUVzUTBGQlVTeEpRVUZETEVOQlFVRXNVMEZCVkN4RlFVRnZRaXhKUVVGRExFTkJRVUVzVFVGQmNrSXNSVUZCTmtJc1NVRkJOMElzUlVGQmJVTXNVVUZCYmtNc1JVRkJOa01zUzBGQk4wTXNSVUZCZFVRc1NVRkJka1FzUlVGQk5rUXNWVUZCTjBRc1JVRkJlVVVzU1VGQlF5eERRVUZCTEV0QlFURkZPMFZCUVhSRE96c3lRa0ZEVWl4SlFVRkJMRWRCUVZFc1UwRkJReXhKUVVGRUxFVkJRVThzU1VGQlVDeEZRVUZoTEZGQlFXSXNSVUZCZFVJc1ZVRkJka0k3VjBGQmMwTXNUMEZCUVN4RFFVRlJMRWxCUVVNc1EwRkJRU3hUUVVGVUxFVkJRVzlDTEVsQlFVTXNRMEZCUVN4TlFVRnlRaXhGUVVFMlFpeEpRVUUzUWl4RlFVRnRReXhSUVVGdVF5eEZRVUUyUXl4TlFVRTNReXhGUVVGMVJDeEpRVUYyUkN4RlFVRTJSQ3hWUVVFM1JDeEZRVUY1UlN4SlFVRkRMRU5CUVVFc1MwRkJNVVU3UlVGQmRFTTdPekpDUVVOU0xFdEJRVUVzUjBGQlVTeFRRVUZETEVsQlFVUXNSVUZCVHl4SlFVRlFMRVZCUVdFc1VVRkJZaXhGUVVGMVFpeFZRVUYyUWp0WFFVRnpReXhQUVVGQkxFTkJRVkVzU1VGQlF5eERRVUZCTEZOQlFWUXNSVUZCYjBJc1NVRkJReXhEUVVGQkxFMUJRWEpDTEVWQlFUWkNMRWxCUVRkQ0xFVkJRVzFETEZGQlFXNURMRVZCUVRaRExFOUJRVGRETEVWQlFYVkVMRWxCUVhaRUxFVkJRVFpFTEZWQlFUZEVMRVZCUVhsRkxFbEJRVU1zUTBGQlFTeExRVUV4UlR0RlFVRjBRenM3TkVKQlExSXNVVUZCUVN4SFFVRlJMRk5CUVVNc1NVRkJSQ3hGUVVGUExGRkJRVkFzUlVGQmRVSXNWVUZCZGtJN1YwRkJjME1zVDBGQlFTeERRVUZSTEVsQlFVTXNRMEZCUVN4VFFVRlVMRVZCUVc5Q0xFbEJRVU1zUTBGQlFTeE5RVUZ5UWl4RlFVRTJRaXhKUVVFM1FpeEZRVUZ0UXl4UlFVRnVReXhGUVVFMlF5eFJRVUUzUXl4RlFVRjFSQ3hKUVVGMlJDeEZRVUUyUkN4VlFVRTNSQ3hGUVVGNVJTeEpRVUZETEVOQlFVRXNTMEZCTVVVN1JVRkJkRU03T3pKQ1FVbFNMRkZCUVVFc1IwRkJWU3hUUVVGRExFbEJRVVFzUlVGQlR5eFJRVUZRTzBGQlIxUXNVVUZCUVR0SlFVRkJMRWxCUVVjc1NVRkJRU3hMUVVGUkxGbEJRVmc3VFVGRlF5eEhRVUZCTEVkQlFVMHNWVUZCUVN4RFFVRlhMRWxCUVVNc1EwRkJRU3hOUVVGYUxFVkJRVzlDTEVkQlFYQkNMRVZCUVhsQ0xFbEJRVU1zUTBGQlFTeE5RVUV4UWl4RlFVRnJReXhKUVVGRExFTkJRVUVzVTBGQmJrTTdUVUZEVGl4aFFVRkJMRWRCUVdkQ08wMUJRMmhDTEUxQlFVRXNSMEZCVXl4SlFVRkpMRmRCUVVvc1EwRkJaMElzUjBGQmFFSTdUVUZGVkN4TlFVRk5MRU5CUVVNc1owSkJRVkFzUTBGQmQwSXNUVUZCZUVJc1JVRkJaME1zUTBGQlFTeFRRVUZCTEV0QlFVRTdaVUZCUVN4VFFVRkJPMVZCUXk5Q0xFbEJRVWNzWVVGQlFTeExRVUZwUWl4alFVRndRanRaUVVORExFdEJRVU1zUTBGQlF5eFBRVUZHTEVkQlFWazdXVUZEV2l4SlFVRjVRaXhuUWtGQmVrSTdZMEZCUVN4UlFVRkJMRU5CUVZNc1YwRkJWQ3hGUVVGQk96dFpRVU5CTEVsQlFYTkdMRXRCUVVNc1EwRkJRU3hMUVVGMlJqdGpRVUZCTEU5QlFVOHNRMEZCUXl4SFFVRlNMRU5CUVZrc05FTkJRVUVzUjBGQk5rTXNTMEZCUXl4RFFVRkJMRk5CUVRsRExFZEJRWGRFTEdWQlFYQkZMRVZCUVVFN1lVRklSRHM3YVVKQlNVRXNZVUZCUVN4SFFVRm5RanRSUVV4bE8wMUJRVUVzUTBGQlFTeERRVUZCTEVOQlFVRXNTVUZCUVN4RFFVRm9RenRoUVU5QkxFMUJRVTBzUTBGQlF5eG5Ra0ZCVUN4RFFVRjNRaXhQUVVGNFFpeEZRVUZwUXl4RFFVRkJMRk5CUVVFc1MwRkJRVHRsUVVGQkxGTkJRVUU3VlVGRGFFTXNTVUZCUnl4aFFVRkJMRXRCUVdsQ0xGZEJRWEJDTzFsQlEwTXNTMEZCUXl4RFFVRkRMRTlCUVVZc1IwRkJXVHRaUVVOYUxFbEJRVFJDTEdkQ1FVRTFRanRqUVVGQkxGRkJRVUVzUTBGQlV5eGpRVUZVTEVWQlFVRTdPMWxCUTBFc1NVRkJhMFlzUzBGQlF5eERRVUZCTEV0QlFXNUdPMk5CUVVFc1QwRkJUeXhEUVVGRExFbEJRVklzUTBGQllTdzBRMEZCUVN4SFFVRTJReXhMUVVGRExFTkJRVUVzVTBGQk9VTXNSMEZCZDBRc1ZVRkJja1VzUlVGQlFUdGhRVWhFT3p0cFFrRkpRU3hoUVVGQkxFZEJRV2RDTzFGQlRHZENPMDFCUVVFc1EwRkJRU3hEUVVGQkxFTkJRVUVzU1VGQlFTeERRVUZxUXl4RlFXSkVPMHRCUVVFc1RVRkJRVHROUVhWQ1F5eEhRVUZCTEVkQlFVMHNWVUZCUVN4RFFVRlhMRWxCUVVNc1EwRkJRU3hOUVVGYUxFVkJRVzlDTEVsQlFYQkNMRVZCUVRCQ0xFbEJRVU1zUTBGQlFTeE5RVUV6UWl4RlFVRnRReXhKUVVGRExFTkJRVUVzVTBGQmNFTTdUVUZEVGl4TlFVRkJMRWRCUVZNc1NVRkJTU3hYUVVGS0xFTkJRV2RDTEVkQlFXaENPMDFCUTFRc1NVRkJiVVlzU1VGQlF5eERRVUZCTEV0QlFYQkdPMUZCUVVFc1QwRkJUeXhEUVVGRExFZEJRVklzUTBGQldTd3dRMEZCUVN4SFFVRXlReXhKUVVFelF5eEhRVUZuUkN4aFFVRm9SQ3hIUVVFMlJDeEhRVUUzUkN4SFFVRnBSU3hIUVVFM1JTeEZRVUZCT3p0TlFVVkJMRTFCUVUwc1EwRkJReXhuUWtGQlVDeERRVUYzUWl4TFFVRjRRaXhGUVVFclFpeERRVUZCTEZOQlFVRXNTMEZCUVR0bFFVRkJMRk5CUVVNc1JVRkJSRHRWUVVNNVFpeEpRVUYzUlN4blFrRkJlRVU3V1VGQlFTeFJRVUZCTEVOQlFWTXNTVUZCU1N4RFFVRkRMRXRCUVV3c1EwRkJWeXhGUVVGRkxFTkJRVU1zU1VGQlpDeERRVUZ0UWl4RFFVRkRMRWxCUVRkQ0xFVkJRVzFETEV0QlFXNURMRVZCUVRCRExFbEJRVWtzUTBGQlF5eExRVUZNTEVOQlFWY3NSVUZCUlN4RFFVRkRMRWxCUVdRc1EwRkJiVUlzUTBGQlF5eExRVUU1UkN4RlFVRkJPenRWUVVOQkxFbEJRWE5JTEV0QlFVTXNRMEZCUVN4TFFVRjJTRHR0UWtGQlFTeFBRVUZQTEVOQlFVTXNSMEZCVWl4RFFVRlpMSE5EUVVGQkxFZEJRWFZETEVsQlFYWkRMRWRCUVRSRExHVkJRVFZETEVkQlFUQkVMRU5CUVVNc1NVRkJTU3hEUVVGRExFdEJRVXdzUTBGQlZ5eEZRVUZGTEVOQlFVTXNTVUZCWkN4RFFVRnRRaXhEUVVGRExFbEJRWEpDTEVOQlFURkVMRWRCUVc5R0xGbEJRWEJHTEVkQlFXZEhMRWRCUVdoSExFZEJRVzlITEVkQlFXaElMRVZCUVVFN08xRkJSamhDTzAxQlFVRXNRMEZCUVN4RFFVRkJMRU5CUVVFc1NVRkJRU3hEUVVFdlFqdGhRVWxCTEUxQlFVMHNRMEZCUXl4blFrRkJVQ3hEUVVGM1FpeFBRVUY0UWl4RlFVRnBReXhEUVVGQkxGTkJRVUVzUzBGQlFUdGxRVUZCTEZOQlFVTXNSVUZCUkR0VlFVTm9ReXhKUVVFd1JTeG5Ra0ZCTVVVN1dVRkJRU3hSUVVGQkxFTkJRVk1zU1VGQlNTeERRVUZETEV0QlFVd3NRMEZCVnl4RlFVRkZMRU5CUVVNc1NVRkJaQ3hEUVVGdFFpeERRVUZETEVsQlFUZENMRVZCUVcxRExFOUJRVzVETEVWQlFUUkRMRWxCUVVrc1EwRkJReXhMUVVGTUxFTkJRVmNzUlVGQlJTeERRVUZETEVsQlFXUXNRMEZCYlVJc1EwRkJReXhMUVVGb1JTeEZRVUZCT3p0VlFVTkJMRWxCUVhkSUxFdEJRVU1zUTBGQlFTeExRVUY2U0R0dFFrRkJRU3hQUVVGUExFTkJRVU1zUjBGQlVpeERRVUZaTEhORFFVRkJMRWRCUVhWRExFbEJRWFpETEVkQlFUUkRMR2xDUVVFMVF5eEhRVUUwUkN4RFFVRkRMRWxCUVVrc1EwRkJReXhMUVVGTUxFTkJRVmNzUlVGQlJTeERRVUZETEVsQlFXUXNRMEZCYlVJc1EwRkJReXhKUVVGeVFpeERRVUUxUkN4SFFVRnpSaXhaUVVGMFJpeEhRVUZyUnl4SFFVRnNSeXhIUVVGelJ5eEhRVUZzU0N4RlFVRkJPenRSUVVablF6dE5RVUZCTEVOQlFVRXNRMEZCUVN4RFFVRkJMRWxCUVVFc1EwRkJha01zUlVFdlFrUTdPMFZCU0ZNN096czdSMEZxUnpCQ0xFMUJRVTBzUTBGQlF5SjlcbiIsInZhciBleHRlbmQgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKGhhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH0sXG4gIGhhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcblxuZXhwb3J0cy5JbnB1dCA9IChmdW5jdGlvbihzdXBlckNsYXNzKSB7XG4gIGV4dGVuZChJbnB1dCwgc3VwZXJDbGFzcyk7XG5cbiAgSW5wdXQuZGVmaW5lKFwic3R5bGVcIiwge1xuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5pbnB1dC5zdHlsZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiBfLmV4dGVuZCh0aGlzLmlucHV0LnN0eWxlLCB2YWx1ZSk7XG4gICAgfVxuICB9KTtcblxuICBJbnB1dC5kZWZpbmUoXCJ2YWx1ZVwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmlucHV0LnZhbHVlO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuaW5wdXQudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIElucHV0KG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyA9PSBudWxsKSB7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuICAgIGlmIChvcHRpb25zLnNldHVwID09IG51bGwpIHtcbiAgICAgIG9wdGlvbnMuc2V0dXAgPSBmYWxzZTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMud2lkdGggPT0gbnVsbCkge1xuICAgICAgb3B0aW9ucy53aWR0aCA9IFNjcmVlbi53aWR0aDtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMuY2xpcCA9PSBudWxsKSB7XG4gICAgICBvcHRpb25zLmNsaXAgPSBmYWxzZTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMuaGVpZ2h0ID09IG51bGwpIHtcbiAgICAgIG9wdGlvbnMuaGVpZ2h0ID0gNjA7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLmJhY2tncm91bmRDb2xvciA9PSBudWxsKSB7XG4gICAgICBvcHRpb25zLmJhY2tncm91bmRDb2xvciA9IG9wdGlvbnMuc2V0dXAgPyBcInJnYmEoMjU1LCA2MCwgNDcsIC41KVwiIDogXCJ0cmFuc3BhcmVudFwiO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5mb250U2l6ZSA9PSBudWxsKSB7XG4gICAgICBvcHRpb25zLmZvbnRTaXplID0gMzA7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLmxpbmVIZWlnaHQgPT0gbnVsbCkge1xuICAgICAgb3B0aW9ucy5saW5lSGVpZ2h0ID0gMzA7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLnBhZGRpbmcgPT0gbnVsbCkge1xuICAgICAgb3B0aW9ucy5wYWRkaW5nID0gMTA7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLmZvbnRGYW1pbHkgPT0gbnVsbCkge1xuICAgICAgb3B0aW9ucy5mb250RmFtaWx5ID0gXCJcIjtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMub3BhY2l0eSA9PSBudWxsKSB7XG4gICAgICBvcHRpb25zLm9wYWNpdHkgPSAxO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy50ZXh0ID09IG51bGwpIHtcbiAgICAgIG9wdGlvbnMudGV4dCA9IFwiXCI7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLnBsYWNlaG9sZGVyID09IG51bGwpIHtcbiAgICAgIG9wdGlvbnMucGxhY2Vob2xkZXIgPSBcIlwiO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy50eXBlID09IG51bGwpIHtcbiAgICAgIG9wdGlvbnMudHlwZSA9IFwidGV4dFwiO1xuICAgIH1cbiAgICBJbnB1dC5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCBvcHRpb25zKTtcbiAgICBpZiAob3B0aW9ucy5wbGFjZWhvbGRlckNvbG9yICE9IG51bGwpIHtcbiAgICAgIHRoaXMucGxhY2Vob2xkZXJDb2xvciA9IG9wdGlvbnMucGxhY2Vob2xkZXJDb2xvcjtcbiAgICB9XG4gICAgdGhpcy5pbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICB0aGlzLmlucHV0LmlkID0gXCJpbnB1dC1cIiArIChfLm5vdygpKTtcbiAgICB0aGlzLmlucHV0LnN0eWxlLmNzc1RleHQgPSBcImZvbnQtc2l6ZTogXCIgKyBvcHRpb25zLmZvbnRTaXplICsgXCJweDsgbGluZS1oZWlnaHQ6IFwiICsgb3B0aW9ucy5saW5lSGVpZ2h0ICsgXCJweDsgcGFkZGluZzogXCIgKyBvcHRpb25zLnBhZGRpbmcgKyBcInB4OyB3aWR0aDogXCIgKyBvcHRpb25zLndpZHRoICsgXCJweDsgaGVpZ2h0OiBcIiArIG9wdGlvbnMuaGVpZ2h0ICsgXCJweDsgYm9yZGVyOiBub25lOyBvdXRsaW5lLXdpZHRoOiAwOyBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoYWJvdXQ6YmxhbmspOyBiYWNrZ3JvdW5kLWNvbG9yOiBcIiArIG9wdGlvbnMuYmFja2dyb3VuZENvbG9yICsgXCI7IGZvbnQtZmFtaWx5OiBcIiArIG9wdGlvbnMuZm9udEZhbWlseSArIFwiOyBvcGFjaXR5OiBcIiArIG9wdGlvbnMub3BhY2l0eSArIFwiO1wiO1xuICAgIHRoaXMuaW5wdXQudmFsdWUgPSBvcHRpb25zLnRleHQ7XG4gICAgdGhpcy5pbnB1dC50eXBlID0gb3B0aW9ucy50eXBlO1xuICAgIHRoaXMuaW5wdXQucGxhY2Vob2xkZXIgPSBvcHRpb25zLnBsYWNlaG9sZGVyO1xuICAgIHRoaXMuZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpO1xuICAgIHRoaXMuZm9ybS5hcHBlbmRDaGlsZCh0aGlzLmlucHV0KTtcbiAgICB0aGlzLl9lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuZm9ybSk7XG4gICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSBcInRyYW5zcGFyZW50XCI7XG4gICAgaWYgKHRoaXMucGxhY2Vob2xkZXJDb2xvcikge1xuICAgICAgdGhpcy51cGRhdGVQbGFjZWhvbGRlckNvbG9yKG9wdGlvbnMucGxhY2Vob2xkZXJDb2xvcik7XG4gICAgfVxuICB9XG5cbiAgSW5wdXQucHJvdG90eXBlLnVwZGF0ZVBsYWNlaG9sZGVyQ29sb3IgPSBmdW5jdGlvbihjb2xvcikge1xuICAgIHZhciBjc3M7XG4gICAgdGhpcy5wbGFjZWhvbGRlckNvbG9yID0gY29sb3I7XG4gICAgaWYgKHRoaXMucGFnZVN0eWxlICE9IG51bGwpIHtcbiAgICAgIGRvY3VtZW50LmhlYWQucmVtb3ZlQ2hpbGQodGhpcy5wYWdlU3R5bGUpO1xuICAgIH1cbiAgICB0aGlzLnBhZ2VTdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcbiAgICB0aGlzLnBhZ2VTdHlsZS50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xuICAgIGNzcyA9IFwiI1wiICsgdGhpcy5pbnB1dC5pZCArIFwiOjotd2Via2l0LWlucHV0LXBsYWNlaG9sZGVyIHsgY29sb3I6IFwiICsgdGhpcy5wbGFjZWhvbGRlckNvbG9yICsgXCI7IH1cIjtcbiAgICB0aGlzLnBhZ2VTdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpKTtcbiAgICByZXR1cm4gZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCh0aGlzLnBhZ2VTdHlsZSk7XG4gIH07XG5cbiAgSW5wdXQucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5wdXQuZm9jdXMoKTtcbiAgfTtcblxuICByZXR1cm4gSW5wdXQ7XG5cbn0pKExheWVyKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pTDFWelpYSnpMMnBsWm1aeVpYa3VhR0Z5Y21sekwwUmxkbVZzYjNCdFpXNTBMMlp5WVcxbGNpMXphMlYwWTJndFptbHlaV0poYzJVdFltOXBiR1Z5Y0d4aGRHVXZjM0pqTDIxdlpIVnNaWE12YVc1d2RYUm1hV1ZzWkM1amIyWm1aV1VpTENKemIzVnlZMlZTYjI5MElqb2lJaXdpYzI5MWNtTmxjeUk2V3lJdlZYTmxjbk12YW1WbVpuSmxlUzVvWVhKeWFYTXZSR1YyWld4dmNHMWxiblF2Wm5KaGJXVnlMWE5yWlhSamFDMW1hWEpsWW1GelpTMWliMmxzWlhKd2JHRjBaUzl6Y21NdmJXOWtkV3hsY3k5cGJuQjFkR1pwWld4a0xtTnZabVpsWlNKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pUVVGRFFTeEpRVUZCT3pzN1FVRkJUU3hQUVVGUExFTkJRVU03T3p0RlFVTmlMRXRCUVVNc1EwRkJRU3hOUVVGRUxFTkJRVkVzVDBGQlVpeEZRVU5ETzBsQlFVRXNSMEZCUVN4RlFVRkxMRk5CUVVFN1lVRkJSeXhKUVVGRExFTkJRVUVzUzBGQlN5eERRVUZETzBsQlFWWXNRMEZCVER0SlFVTkJMRWRCUVVFc1JVRkJTeXhUUVVGRExFdEJRVVE3WVVGRFNpeERRVUZETEVOQlFVTXNUVUZCUml4RFFVRlRMRWxCUVVNc1EwRkJRU3hMUVVGTExFTkJRVU1zUzBGQmFFSXNSVUZCZFVJc1MwRkJka0k3U1VGRVNTeERRVVJNTzBkQlJFUTdPMFZCUzBFc1MwRkJReXhEUVVGQkxFMUJRVVFzUTBGQlVTeFBRVUZTTEVWQlEwTTdTVUZCUVN4SFFVRkJMRVZCUVVzc1UwRkJRVHRoUVVGSExFbEJRVU1zUTBGQlFTeExRVUZMTEVOQlFVTTdTVUZCVml4RFFVRk1PMGxCUTBFc1IwRkJRU3hGUVVGTExGTkJRVU1zUzBGQlJEdGhRVU5LTEVsQlFVTXNRMEZCUVN4TFFVRkxMRU5CUVVNc1MwRkJVQ3hIUVVGbE8wbEJSRmdzUTBGRVREdEhRVVJFT3p0RlFVdGhMR1ZCUVVNc1QwRkJSRHM3VFVGQlF5eFZRVUZWT3pzN1RVRkRka0lzVDBGQlR5eERRVUZETEZGQlFWTTdPenROUVVOcVFpeFBRVUZQTEVOQlFVTXNVVUZCVXl4TlFVRk5MRU5CUVVNN096dE5RVU40UWl4UFFVRlBMRU5CUVVNc1QwRkJVVHM3TzAxQlEyaENMRTlCUVU4c1EwRkJReXhUUVVGVk96czdUVUZEYkVJc1QwRkJUeXhEUVVGRExHdENRVUZ6UWl4UFFVRlBMRU5CUVVNc1MwRkJXQ3hIUVVGelFpeDFRa0ZCZEVJc1IwRkJiVVE3T3p0TlFVTTVSU3hQUVVGUExFTkJRVU1zVjBGQldUczdPMDFCUTNCQ0xFOUJRVThzUTBGQlF5eGhRVUZqT3pzN1RVRkRkRUlzVDBGQlR5eERRVUZETEZWQlFWYzdPenROUVVOdVFpeFBRVUZQTEVOQlFVTXNZVUZCWXpzN08wMUJRM1JDTEU5QlFVOHNRMEZCUXl4VlFVRlhPenM3VFVGRGJrSXNUMEZCVHl4RFFVRkRMRTlCUVZFN096dE5RVU5vUWl4UFFVRlBMRU5CUVVNc1kwRkJaVHM3TzAxQlEzWkNMRTlCUVU4c1EwRkJReXhQUVVGUk96dEpRVVZvUWl4MVEwRkJUU3hQUVVGT08wbEJSVUVzU1VGQlowUXNaME5CUVdoRU8wMUJRVUVzU1VGQlF5eERRVUZCTEdkQ1FVRkVMRWRCUVc5Q0xFOUJRVThzUTBGQlF5eHBRa0ZCTlVJN08wbEJRMEVzU1VGQlF5eERRVUZCTEV0QlFVUXNSMEZCVXl4UlFVRlJMRU5CUVVNc1lVRkJWQ3hEUVVGMVFpeFBRVUYyUWp0SlFVTlVMRWxCUVVNc1EwRkJRU3hMUVVGTExFTkJRVU1zUlVGQlVDeEhRVUZaTEZGQlFVRXNSMEZCVVN4RFFVRkRMRU5CUVVNc1EwRkJReXhIUVVGR0xFTkJRVUVzUTBGQlJEdEpRVU53UWl4SlFVRkRMRU5CUVVFc1MwRkJTeXhEUVVGRExFdEJRVXNzUTBGQlF5eFBRVUZpTEVkQlFYVkNMR0ZCUVVFc1IwRkJZeXhQUVVGUExFTkJRVU1zVVVGQmRFSXNSMEZCSzBJc2JVSkJRUzlDTEVkQlFXdEVMRTlCUVU4c1EwRkJReXhWUVVFeFJDeEhRVUZ4UlN4bFFVRnlSU3hIUVVGdlJpeFBRVUZQTEVOQlFVTXNUMEZCTlVZc1IwRkJiMGNzWVVGQmNFY3NSMEZCYVVnc1QwRkJUeXhEUVVGRExFdEJRWHBJTEVkQlFTdElMR05CUVM5SUxFZEJRVFpKTEU5QlFVOHNRMEZCUXl4TlFVRnlTaXhIUVVFMFNpdzBSa0ZCTlVvc1IwRkJkMUFzVDBGQlR5eERRVUZETEdWQlFXaFJMRWRCUVdkU0xHbENRVUZvVWl4SFFVRnBVeXhQUVVGUExFTkJRVU1zVlVGQmVsTXNSMEZCYjFRc1lVRkJjRlFzUjBGQmFWVXNUMEZCVHl4RFFVRkRMRTlCUVhwVkxFZEJRV2xXTzBsQlEzaFhMRWxCUVVNc1EwRkJRU3hMUVVGTExFTkJRVU1zUzBGQlVDeEhRVUZsTEU5QlFVOHNRMEZCUXp0SlFVTjJRaXhKUVVGRExFTkJRVUVzUzBGQlN5eERRVUZETEVsQlFWQXNSMEZCWXl4UFFVRlBMRU5CUVVNN1NVRkRkRUlzU1VGQlF5eERRVUZCTEV0QlFVc3NRMEZCUXl4WFFVRlFMRWRCUVhGQ0xFOUJRVThzUTBGQlF6dEpRVU0zUWl4SlFVRkRMRU5CUVVFc1NVRkJSQ3hIUVVGUkxGRkJRVkVzUTBGQlF5eGhRVUZVTEVOQlFYVkNMRTFCUVhaQ08wbEJSVklzU1VGQlF5eERRVUZCTEVsQlFVa3NRMEZCUXl4WFFVRk9MRU5CUVd0Q0xFbEJRVU1zUTBGQlFTeExRVUZ1UWp0SlFVTkJMRWxCUVVNc1EwRkJRU3hSUVVGUkxFTkJRVU1zVjBGQlZpeERRVUZ6UWl4SlFVRkRMRU5CUVVFc1NVRkJka0k3U1VGRlFTeEpRVUZETEVOQlFVRXNaVUZCUkN4SFFVRnRRanRKUVVOdVFpeEpRVUZ2UkN4SlFVRkRMRU5CUVVFc1owSkJRWEpFTzAxQlFVRXNTVUZCUXl4RFFVRkJMSE5DUVVGRUxFTkJRWGRDTEU5QlFVOHNRMEZCUXl4blFrRkJhRU1zUlVGQlFUczdSVUU1UWxrN08ydENRV2REWWl4elFrRkJRU3hIUVVGM1FpeFRRVUZETEV0QlFVUTdRVUZEZGtJc1VVRkJRVHRKUVVGQkxFbEJRVU1zUTBGQlFTeG5Ra0ZCUkN4SFFVRnZRanRKUVVOd1FpeEpRVUZITEhOQ1FVRklPMDFCUTBNc1VVRkJVU3hEUVVGRExFbEJRVWtzUTBGQlF5eFhRVUZrTEVOQlFUQkNMRWxCUVVNc1EwRkJRU3hUUVVFelFpeEZRVVJFT3p0SlFVVkJMRWxCUVVNc1EwRkJRU3hUUVVGRUxFZEJRV0VzVVVGQlVTeERRVUZETEdGQlFWUXNRMEZCZFVJc1QwRkJka0k3U1VGRFlpeEpRVUZETEVOQlFVRXNVMEZCVXl4RFFVRkRMRWxCUVZnc1IwRkJhMEk3U1VGRGJFSXNSMEZCUVN4SFFVRk5MRWRCUVVFc1IwRkJTU3hKUVVGRExFTkJRVUVzUzBGQlN5eERRVUZETEVWQlFWZ3NSMEZCWXl4MVEwRkJaQ3hIUVVGeFJDeEpRVUZETEVOQlFVRXNaMEpCUVhSRUxFZEJRWFZGTzBsQlF6ZEZMRWxCUVVNc1EwRkJRU3hUUVVGVExFTkJRVU1zVjBGQldDeERRVUYxUWl4UlFVRlJMRU5CUVVNc1kwRkJWQ3hEUVVGM1FpeEhRVUY0UWl4RFFVRjJRanRYUVVOQkxGRkJRVkVzUTBGQlF5eEpRVUZKTEVOQlFVTXNWMEZCWkN4RFFVRXdRaXhKUVVGRExFTkJRVUVzVTBGQk0wSTdSVUZTZFVJN08ydENRVlY0UWl4TFFVRkJMRWRCUVU4c1UwRkJRVHRYUVVOT0xFbEJRVU1zUTBGQlFTeExRVUZMTEVOQlFVTXNTMEZCVUN4RFFVRkJPMFZCUkUwN096czdSMEZ5Ukc5Q0luMD1cbiJdfQ=="}